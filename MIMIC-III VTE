{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "7d3931e7",
   "metadata": {
    "tags": []
   },
   "source": [
    "# Load Dataset"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "1dc265b1",
   "metadata": {},
   "outputs": [],
   "source": [
    "# set up notebook\n",
    "import os\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import sqlalchemy\n",
    "import seaborn as sns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "01b630ad",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/kexinzhang/opt/anaconda3/lib/python3.9/site-packages/IPython/core/interactiveshell.py:3444: DtypeWarning: Columns (11) have mixed types.Specify dtype option on import or set low_memory=False.\n",
      "  exec(code_obj, self.user_global_ns, self.user_ns)\n"
     ]
    }
   ],
   "source": [
    "# read the admissions table\n",
    "df_adm = pd.read_csv('ADMISSIONS.csv')\n",
    "df_pat = pd.read_csv('PATIENTS.csv')\n",
    "df_icu = pd.read_csv('ICUSTAYS.csv')\n",
    "df_presc = pd.read_csv('PRESCRIPTIONS.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "38a0c230",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/kexinzhang/opt/anaconda3/lib/python3.9/site-packages/IPython/core/interactiveshell.py:3444: DtypeWarning: Columns (7,9,17,20,21) have mixed types.Specify dtype option on import or set low_memory=False.\n",
      "  exec(code_obj, self.user_global_ns, self.user_ns)\n"
     ]
    }
   ],
   "source": [
    "df_ineven = pd.read_csv('INPUTEVENTS_CV.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "90cd78bc-87de-48ed-92b4-0f9cb0e0b645",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_dicd_dia = pd.read_csv('D_ICD_DIAGNOSES.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "433f4356-fe2f-4636-bbc0-3206c58da258",
   "metadata": {},
   "outputs": [],
   "source": [
    "#df_proce = pd.read_csv('PROCEDUREEVENTS_MV.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "8942ad24-d3ad-4833-9dd8-4038358883c8",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_dia_icd = pd.read_csv('DIAGNOSES_ICD.csv.gz', compression='gzip', header=0, sep=',', quotechar='\"')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 205,
   "id": "093f8ddb-eff4-4153-8b5a-10e0b8f3266d",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_proce = pd.read_csv('PROCEDURES_ICD.csv.gz', compression='gzip', header=0, sep=',', quotechar='\"')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "26956aff-be27-4959-a5e0-dbcd81ce1a79",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_d_proce = pd.read_csv('D_ICD_PROCEDURES.csv.gz', compression='gzip', header=0, sep=',', quotechar='\"')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5bf67667-cfd0-4c99-8449-c64e612a78c6",
   "metadata": {
    "jp-MarkdownHeadingCollapsed": true,
    "tags": []
   },
   "source": [
    "# Count Number of Total People (Whole Data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "d14f2ea9-a655-41b5-af9a-8e33e5636047",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ROW_ID</th>\n",
       "      <th>SUBJECT_ID</th>\n",
       "      <th>GENDER</th>\n",
       "      <th>DOB</th>\n",
       "      <th>DOD</th>\n",
       "      <th>DOD_HOSP</th>\n",
       "      <th>DOD_SSN</th>\n",
       "      <th>EXPIRE_FLAG</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>234</td>\n",
       "      <td>249</td>\n",
       "      <td>F</td>\n",
       "      <td>2075-03-13 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>235</td>\n",
       "      <td>250</td>\n",
       "      <td>F</td>\n",
       "      <td>2164-12-27 00:00:00</td>\n",
       "      <td>2188-11-22 00:00:00</td>\n",
       "      <td>2188-11-22 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>236</td>\n",
       "      <td>251</td>\n",
       "      <td>M</td>\n",
       "      <td>2090-03-15 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>237</td>\n",
       "      <td>252</td>\n",
       "      <td>M</td>\n",
       "      <td>2078-03-06 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>238</td>\n",
       "      <td>253</td>\n",
       "      <td>F</td>\n",
       "      <td>2089-11-26 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   ROW_ID  SUBJECT_ID GENDER                  DOB                  DOD  \\\n",
       "0     234         249      F  2075-03-13 00:00:00                  NaN   \n",
       "1     235         250      F  2164-12-27 00:00:00  2188-11-22 00:00:00   \n",
       "2     236         251      M  2090-03-15 00:00:00                  NaN   \n",
       "3     237         252      M  2078-03-06 00:00:00                  NaN   \n",
       "4     238         253      F  2089-11-26 00:00:00                  NaN   \n",
       "\n",
       "              DOD_HOSP DOD_SSN  EXPIRE_FLAG  \n",
       "0                  NaN     NaN            0  \n",
       "1  2188-11-22 00:00:00     NaN            1  \n",
       "2                  NaN     NaN            0  \n",
       "3                  NaN     NaN            0  \n",
       "4                  NaN     NaN            0  "
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_pat.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "e4081f94-dc1d-44fc-9129-594e9c8788c6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "M    26121\n",
       "F    20399\n",
       "Name: GENDER, dtype: int64"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_pat.GENDER.value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "5ed5289d-c929-430c-8fc4-096c11ff9b6b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Total number of patient is : 46520\n"
     ]
    }
   ],
   "source": [
    "gender_total = df_pat.SUBJECT_ID.nunique()\n",
    "print(\"Total number of patient is :\", gender_total )"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "99ff5d8e-87a2-44f9-a61d-ba04bc71d46b",
   "metadata": {},
   "source": [
    "#### Convert dates"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "3504f349-78fd-401f-bbba-6aa1ed4530c5",
   "metadata": {},
   "outputs": [],
   "source": [
    "#df_pat.DOB = pd.to_datetime(df_pat.DOB, format = '%Y-%m-%d %H:%M:%S', errors = 'coerce')\n",
    "#df_pat.DOD = pd.to_datetime(df_pat.DOD, format = '%Y-%m-%d %H:%M:%S', errors = 'coerce')\n",
    "#df_adm.ADMITTIME = pd.to_datetime(df_adm.ADMITTIME, format = '%Y-%m-%d %H:%M:%S', errors = 'coerce')\n",
    "\n",
    "#df_pat.DOB = pd.to_datetime(df_pat.DOB).dt.date\n",
    "#df_adm.ADMITTIME = pd.to_datetime(df_adm.ADMITTIME).dt.date\n",
    "\n",
    "#type(df_pat.DOB[1])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "d5a499da-5c58-4503-a15e-824a45326791",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ROW_ID</th>\n",
       "      <th>SUBJECT_ID</th>\n",
       "      <th>GENDER</th>\n",
       "      <th>DOB</th>\n",
       "      <th>DOD</th>\n",
       "      <th>DOD_HOSP</th>\n",
       "      <th>DOD_SSN</th>\n",
       "      <th>EXPIRE_FLAG</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>222</th>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>M</td>\n",
       "      <td>2138-07-17 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>223</th>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>M</td>\n",
       "      <td>2025-04-11 00:00:00</td>\n",
       "      <td>2102-06-14 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2102-06-14 00:00:00</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>224</th>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>F</td>\n",
       "      <td>2143-05-12 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>225</th>\n",
       "      <td>4</td>\n",
       "      <td>5</td>\n",
       "      <td>M</td>\n",
       "      <td>2103-02-02 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>226</th>\n",
       "      <td>5</td>\n",
       "      <td>6</td>\n",
       "      <td>F</td>\n",
       "      <td>2109-06-21 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>41091</th>\n",
       "      <td>46516</td>\n",
       "      <td>99985</td>\n",
       "      <td>M</td>\n",
       "      <td>2127-04-08 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>41092</th>\n",
       "      <td>46517</td>\n",
       "      <td>99991</td>\n",
       "      <td>M</td>\n",
       "      <td>2137-04-07 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>41093</th>\n",
       "      <td>46518</td>\n",
       "      <td>99992</td>\n",
       "      <td>F</td>\n",
       "      <td>2078-10-17 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>41094</th>\n",
       "      <td>46519</td>\n",
       "      <td>99995</td>\n",
       "      <td>F</td>\n",
       "      <td>2058-05-29 00:00:00</td>\n",
       "      <td>2147-09-29 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2147-09-29 00:00:00</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>41095</th>\n",
       "      <td>46520</td>\n",
       "      <td>99999</td>\n",
       "      <td>F</td>\n",
       "      <td>2054-01-06 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>46520 rows × 8 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       ROW_ID  SUBJECT_ID GENDER                  DOB                  DOD  \\\n",
       "222         1           2      M  2138-07-17 00:00:00                  NaN   \n",
       "223         2           3      M  2025-04-11 00:00:00  2102-06-14 00:00:00   \n",
       "224         3           4      F  2143-05-12 00:00:00                  NaN   \n",
       "225         4           5      M  2103-02-02 00:00:00                  NaN   \n",
       "226         5           6      F  2109-06-21 00:00:00                  NaN   \n",
       "...       ...         ...    ...                  ...                  ...   \n",
       "41091   46516       99985      M  2127-04-08 00:00:00                  NaN   \n",
       "41092   46517       99991      M  2137-04-07 00:00:00                  NaN   \n",
       "41093   46518       99992      F  2078-10-17 00:00:00                  NaN   \n",
       "41094   46519       99995      F  2058-05-29 00:00:00  2147-09-29 00:00:00   \n",
       "41095   46520       99999      F  2054-01-06 00:00:00                  NaN   \n",
       "\n",
       "      DOD_HOSP              DOD_SSN  EXPIRE_FLAG  \n",
       "222        NaN                  NaN            0  \n",
       "223        NaN  2102-06-14 00:00:00            1  \n",
       "224        NaN                  NaN            0  \n",
       "225        NaN                  NaN            0  \n",
       "226        NaN                  NaN            0  \n",
       "...        ...                  ...          ...  \n",
       "41091      NaN                  NaN            0  \n",
       "41092      NaN                  NaN            0  \n",
       "41093      NaN                  NaN            0  \n",
       "41094      NaN  2147-09-29 00:00:00            1  \n",
       "41095      NaN                  NaN            0  \n",
       "\n",
       "[46520 rows x 8 columns]"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_pat.sort_values(by=['SUBJECT_ID'])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e1f7cdb9-2a81-46f9-8e9e-399932aeef9c",
   "metadata": {
    "tags": []
   },
   "source": [
    "# Count Ethnicity, Marital status, and Admission type (Whole Data)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "5d43be0a-e984-462f-b12f-b02a271688e8",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/var/folders/73/37k4t3k50d7gry5vs9_z5yth0000gn/T/ipykernel_9786/2112481919.py:3: FutureWarning: The default value of regex will change from True to False in a future version.\n",
      "  df_adm['ETHNICITY'] = df_adm['ETHNICITY'].str.replace(regex_black, 'BLACK')\n",
      "/var/folders/73/37k4t3k50d7gry5vs9_z5yth0000gn/T/ipykernel_9786/2112481919.py:6: FutureWarning: The default value of regex will change from True to False in a future version.\n",
      "  df_adm['ETHNICITY'] = df_adm['ETHNICITY'].str.replace(regx_white, 'WHITE')\n",
      "/var/folders/73/37k4t3k50d7gry5vs9_z5yth0000gn/T/ipykernel_9786/2112481919.py:9: FutureWarning: The default value of regex will change from True to False in a future version.\n",
      "  df_adm['ETHNICITY'] = df_adm['ETHNICITY'].str.replace(regx_asian, 'ASIAN')\n",
      "/var/folders/73/37k4t3k50d7gry5vs9_z5yth0000gn/T/ipykernel_9786/2112481919.py:12: FutureWarning: The default value of regex will change from True to False in a future version.\n",
      "  df_adm['ETHNICITY'] = df_adm['ETHNICITY'].str.replace(regx_hispanic, 'HISPANIC OR LATINO')\n"
     ]
    }
   ],
   "source": [
    "# Summarize Ethnicity\n",
    "regex_black = '(BLACK(/| )([A-Z]| )*)'\n",
    "df_adm['ETHNICITY'] = df_adm['ETHNICITY'].str.replace(regex_black, 'BLACK')\n",
    "\n",
    "regx_white = '(WHITE - [A-Z ]*)'\n",
    "df_adm['ETHNICITY'] = df_adm['ETHNICITY'].str.replace(regx_white, 'WHITE')\n",
    "\n",
    "regx_asian = '(ASIAN (- )?[A-Z ]*)'\n",
    "df_adm['ETHNICITY'] = df_adm['ETHNICITY'].str.replace(regx_asian, 'ASIAN')\n",
    "\n",
    "regx_hispanic = '(HISPANIC/LATINO - [A-Z \\(\\)]*)|(HISPANIC OR LATINO([A-Z \\(\\)]*))'\n",
    "df_adm['ETHNICITY'] = df_adm['ETHNICITY'].str.replace(regx_hispanic, 'HISPANIC OR LATINO')"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3db0e91f-99cf-4e41-9b21-2c2c1665f545",
   "metadata": {},
   "source": [
    "#### Dropping Duplicate Subject_id"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "16fc3cf4-5ef5-4b63-92b4-77c9143c20f2",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_uniadm = df_adm.drop_duplicates(subset=[\"SUBJECT_ID\"], keep='last')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "17e0d1e5-0816-4158-9249-94ca351834ee",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ROW_ID</th>\n",
       "      <th>SUBJECT_ID</th>\n",
       "      <th>HADM_ID</th>\n",
       "      <th>ADMITTIME</th>\n",
       "      <th>DISCHTIME</th>\n",
       "      <th>DEATHTIME</th>\n",
       "      <th>ADMISSION_TYPE</th>\n",
       "      <th>ADMISSION_LOCATION</th>\n",
       "      <th>DISCHARGE_LOCATION</th>\n",
       "      <th>INSURANCE</th>\n",
       "      <th>LANGUAGE</th>\n",
       "      <th>RELIGION</th>\n",
       "      <th>MARITAL_STATUS</th>\n",
       "      <th>ETHNICITY</th>\n",
       "      <th>EDREGTIME</th>\n",
       "      <th>EDOUTTIME</th>\n",
       "      <th>DIAGNOSIS</th>\n",
       "      <th>HOSPITAL_EXPIRE_FLAG</th>\n",
       "      <th>HAS_CHARTEVENTS_DATA</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>211</th>\n",
       "      <td>1</td>\n",
       "      <td>2</td>\n",
       "      <td>163353</td>\n",
       "      <td>2138-07-17 19:04:00</td>\n",
       "      <td>2138-07-21 15:48:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NEWBORN</td>\n",
       "      <td>PHYS REFERRAL/NORMAL DELI</td>\n",
       "      <td>HOME</td>\n",
       "      <td>Private</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NOT SPECIFIED</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ASIAN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NEWBORN</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>212</th>\n",
       "      <td>2</td>\n",
       "      <td>3</td>\n",
       "      <td>145834</td>\n",
       "      <td>2101-10-20 19:08:00</td>\n",
       "      <td>2101-10-31 13:58:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>EMERGENCY ROOM ADMIT</td>\n",
       "      <td>SNF</td>\n",
       "      <td>Medicare</td>\n",
       "      <td>NaN</td>\n",
       "      <td>CATHOLIC</td>\n",
       "      <td>MARRIED</td>\n",
       "      <td>WHITE</td>\n",
       "      <td>2101-10-20 17:09:00</td>\n",
       "      <td>2101-10-20 19:24:00</td>\n",
       "      <td>HYPOTENSION</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>213</th>\n",
       "      <td>3</td>\n",
       "      <td>4</td>\n",
       "      <td>185777</td>\n",
       "      <td>2191-03-16 00:28:00</td>\n",
       "      <td>2191-03-23 18:41:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>EMERGENCY ROOM ADMIT</td>\n",
       "      <td>HOME WITH HOME IV PROVIDR</td>\n",
       "      <td>Private</td>\n",
       "      <td>NaN</td>\n",
       "      <td>PROTESTANT QUAKER</td>\n",
       "      <td>SINGLE</td>\n",
       "      <td>WHITE</td>\n",
       "      <td>2191-03-15 13:10:00</td>\n",
       "      <td>2191-03-16 01:10:00</td>\n",
       "      <td>FEVER,DEHYDRATION,FAILURE TO THRIVE</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>214</th>\n",
       "      <td>4</td>\n",
       "      <td>5</td>\n",
       "      <td>178980</td>\n",
       "      <td>2103-02-02 04:31:00</td>\n",
       "      <td>2103-02-04 12:15:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NEWBORN</td>\n",
       "      <td>PHYS REFERRAL/NORMAL DELI</td>\n",
       "      <td>HOME</td>\n",
       "      <td>Private</td>\n",
       "      <td>NaN</td>\n",
       "      <td>BUDDHIST</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ASIAN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NEWBORN</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>215</th>\n",
       "      <td>5</td>\n",
       "      <td>6</td>\n",
       "      <td>107064</td>\n",
       "      <td>2175-05-30 07:15:00</td>\n",
       "      <td>2175-06-15 16:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ELECTIVE</td>\n",
       "      <td>PHYS REFERRAL/NORMAL DELI</td>\n",
       "      <td>HOME HEALTH CARE</td>\n",
       "      <td>Medicare</td>\n",
       "      <td>ENGL</td>\n",
       "      <td>NOT SPECIFIED</td>\n",
       "      <td>MARRIED</td>\n",
       "      <td>WHITE</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>CHRONIC RENAL FAILURE/SDA</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56435</th>\n",
       "      <td>58972</td>\n",
       "      <td>99985</td>\n",
       "      <td>176670</td>\n",
       "      <td>2181-01-27 02:47:00</td>\n",
       "      <td>2181-02-12 17:05:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>EMERGENCY ROOM ADMIT</td>\n",
       "      <td>HOME HEALTH CARE</td>\n",
       "      <td>Private</td>\n",
       "      <td>ENGL</td>\n",
       "      <td>JEWISH</td>\n",
       "      <td>MARRIED</td>\n",
       "      <td>WHITE</td>\n",
       "      <td>2181-01-26 23:35:00</td>\n",
       "      <td>2181-01-27 04:18:00</td>\n",
       "      <td>FEVER</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56436</th>\n",
       "      <td>58973</td>\n",
       "      <td>99991</td>\n",
       "      <td>151118</td>\n",
       "      <td>2184-12-24 08:30:00</td>\n",
       "      <td>2185-01-05 12:15:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ELECTIVE</td>\n",
       "      <td>PHYS REFERRAL/NORMAL DELI</td>\n",
       "      <td>HOME</td>\n",
       "      <td>Private</td>\n",
       "      <td>ENGL</td>\n",
       "      <td>NOT SPECIFIED</td>\n",
       "      <td>MARRIED</td>\n",
       "      <td>WHITE</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>DIVERTICULITIS/SDA</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56437</th>\n",
       "      <td>58974</td>\n",
       "      <td>99992</td>\n",
       "      <td>197084</td>\n",
       "      <td>2144-07-25 18:03:00</td>\n",
       "      <td>2144-07-28 17:56:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>CLINIC REFERRAL/PREMATURE</td>\n",
       "      <td>SNF</td>\n",
       "      <td>Medicare</td>\n",
       "      <td>ENGL</td>\n",
       "      <td>CATHOLIC</td>\n",
       "      <td>WIDOWED</td>\n",
       "      <td>WHITE</td>\n",
       "      <td>2144-07-25 13:40:00</td>\n",
       "      <td>2144-07-25 18:50:00</td>\n",
       "      <td>RETROPERITONEAL HEMORRHAGE</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56565</th>\n",
       "      <td>58975</td>\n",
       "      <td>99995</td>\n",
       "      <td>137810</td>\n",
       "      <td>2147-02-08 08:00:00</td>\n",
       "      <td>2147-02-11 13:15:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ELECTIVE</td>\n",
       "      <td>PHYS REFERRAL/NORMAL DELI</td>\n",
       "      <td>HOME</td>\n",
       "      <td>Medicare</td>\n",
       "      <td>ENGL</td>\n",
       "      <td>NOT SPECIFIED</td>\n",
       "      <td>MARRIED</td>\n",
       "      <td>WHITE</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ABDOMINAL AORTIC ANEURYSM/SDA</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>56566</th>\n",
       "      <td>58976</td>\n",
       "      <td>99999</td>\n",
       "      <td>113369</td>\n",
       "      <td>2117-12-30 07:15:00</td>\n",
       "      <td>2118-01-04 16:30:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ELECTIVE</td>\n",
       "      <td>PHYS REFERRAL/NORMAL DELI</td>\n",
       "      <td>SNF</td>\n",
       "      <td>Medicare</td>\n",
       "      <td>SPAN</td>\n",
       "      <td>JEHOVAH'S WITNESS</td>\n",
       "      <td>SEPARATED</td>\n",
       "      <td>HISPANIC OR LATINO</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>SPONDYLOLISTHESIS/SDA</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>46520 rows × 19 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       ROW_ID  SUBJECT_ID  HADM_ID            ADMITTIME            DISCHTIME  \\\n",
       "211         1           2   163353  2138-07-17 19:04:00  2138-07-21 15:48:00   \n",
       "212         2           3   145834  2101-10-20 19:08:00  2101-10-31 13:58:00   \n",
       "213         3           4   185777  2191-03-16 00:28:00  2191-03-23 18:41:00   \n",
       "214         4           5   178980  2103-02-02 04:31:00  2103-02-04 12:15:00   \n",
       "215         5           6   107064  2175-05-30 07:15:00  2175-06-15 16:00:00   \n",
       "...       ...         ...      ...                  ...                  ...   \n",
       "56435   58972       99985   176670  2181-01-27 02:47:00  2181-02-12 17:05:00   \n",
       "56436   58973       99991   151118  2184-12-24 08:30:00  2185-01-05 12:15:00   \n",
       "56437   58974       99992   197084  2144-07-25 18:03:00  2144-07-28 17:56:00   \n",
       "56565   58975       99995   137810  2147-02-08 08:00:00  2147-02-11 13:15:00   \n",
       "56566   58976       99999   113369  2117-12-30 07:15:00  2118-01-04 16:30:00   \n",
       "\n",
       "      DEATHTIME ADMISSION_TYPE         ADMISSION_LOCATION  \\\n",
       "211         NaN        NEWBORN  PHYS REFERRAL/NORMAL DELI   \n",
       "212         NaN      EMERGENCY       EMERGENCY ROOM ADMIT   \n",
       "213         NaN      EMERGENCY       EMERGENCY ROOM ADMIT   \n",
       "214         NaN        NEWBORN  PHYS REFERRAL/NORMAL DELI   \n",
       "215         NaN       ELECTIVE  PHYS REFERRAL/NORMAL DELI   \n",
       "...         ...            ...                        ...   \n",
       "56435       NaN      EMERGENCY       EMERGENCY ROOM ADMIT   \n",
       "56436       NaN       ELECTIVE  PHYS REFERRAL/NORMAL DELI   \n",
       "56437       NaN      EMERGENCY  CLINIC REFERRAL/PREMATURE   \n",
       "56565       NaN       ELECTIVE  PHYS REFERRAL/NORMAL DELI   \n",
       "56566       NaN       ELECTIVE  PHYS REFERRAL/NORMAL DELI   \n",
       "\n",
       "              DISCHARGE_LOCATION INSURANCE LANGUAGE           RELIGION  \\\n",
       "211                         HOME   Private      NaN      NOT SPECIFIED   \n",
       "212                          SNF  Medicare      NaN           CATHOLIC   \n",
       "213    HOME WITH HOME IV PROVIDR   Private      NaN  PROTESTANT QUAKER   \n",
       "214                         HOME   Private      NaN           BUDDHIST   \n",
       "215             HOME HEALTH CARE  Medicare     ENGL      NOT SPECIFIED   \n",
       "...                          ...       ...      ...                ...   \n",
       "56435           HOME HEALTH CARE   Private     ENGL             JEWISH   \n",
       "56436                       HOME   Private     ENGL      NOT SPECIFIED   \n",
       "56437                        SNF  Medicare     ENGL           CATHOLIC   \n",
       "56565                       HOME  Medicare     ENGL      NOT SPECIFIED   \n",
       "56566                        SNF  Medicare     SPAN  JEHOVAH'S WITNESS   \n",
       "\n",
       "      MARITAL_STATUS           ETHNICITY            EDREGTIME  \\\n",
       "211              NaN               ASIAN                  NaN   \n",
       "212          MARRIED               WHITE  2101-10-20 17:09:00   \n",
       "213           SINGLE               WHITE  2191-03-15 13:10:00   \n",
       "214              NaN               ASIAN                  NaN   \n",
       "215          MARRIED               WHITE                  NaN   \n",
       "...              ...                 ...                  ...   \n",
       "56435        MARRIED               WHITE  2181-01-26 23:35:00   \n",
       "56436        MARRIED               WHITE                  NaN   \n",
       "56437        WIDOWED               WHITE  2144-07-25 13:40:00   \n",
       "56565        MARRIED               WHITE                  NaN   \n",
       "56566      SEPARATED  HISPANIC OR LATINO                  NaN   \n",
       "\n",
       "                 EDOUTTIME                            DIAGNOSIS  \\\n",
       "211                    NaN                              NEWBORN   \n",
       "212    2101-10-20 19:24:00                          HYPOTENSION   \n",
       "213    2191-03-16 01:10:00  FEVER,DEHYDRATION,FAILURE TO THRIVE   \n",
       "214                    NaN                              NEWBORN   \n",
       "215                    NaN            CHRONIC RENAL FAILURE/SDA   \n",
       "...                    ...                                  ...   \n",
       "56435  2181-01-27 04:18:00                                FEVER   \n",
       "56436                  NaN                   DIVERTICULITIS/SDA   \n",
       "56437  2144-07-25 18:50:00           RETROPERITONEAL HEMORRHAGE   \n",
       "56565                  NaN        ABDOMINAL AORTIC ANEURYSM/SDA   \n",
       "56566                  NaN                SPONDYLOLISTHESIS/SDA   \n",
       "\n",
       "       HOSPITAL_EXPIRE_FLAG  HAS_CHARTEVENTS_DATA  \n",
       "211                       0                     1  \n",
       "212                       0                     1  \n",
       "213                       0                     1  \n",
       "214                       0                     1  \n",
       "215                       0                     1  \n",
       "...                     ...                   ...  \n",
       "56435                     0                     1  \n",
       "56436                     0                     1  \n",
       "56437                     0                     1  \n",
       "56565                     0                     1  \n",
       "56566                     0                     1  \n",
       "\n",
       "[46520 rows x 19 columns]"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_uniadm.sort_values(by=['SUBJECT_ID'])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "6a6239e8-04c6-4215-a952-113aa10611d1",
   "metadata": {},
   "source": [
    "#### Combine patient and admission df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "4e093a67-74a0-4da5-9b72-3a32447a28a0",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_merge=pd.merge(df_pat, df_uniadm, how='outer', on='SUBJECT_ID')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "16536122-0930-4a6f-842d-fdcb19c79bd4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ROW_ID_x</th>\n",
       "      <th>SUBJECT_ID</th>\n",
       "      <th>GENDER</th>\n",
       "      <th>DOB</th>\n",
       "      <th>DOD</th>\n",
       "      <th>DOD_HOSP</th>\n",
       "      <th>DOD_SSN</th>\n",
       "      <th>EXPIRE_FLAG</th>\n",
       "      <th>ROW_ID_y</th>\n",
       "      <th>HADM_ID</th>\n",
       "      <th>...</th>\n",
       "      <th>INSURANCE</th>\n",
       "      <th>LANGUAGE</th>\n",
       "      <th>RELIGION</th>\n",
       "      <th>MARITAL_STATUS</th>\n",
       "      <th>ETHNICITY</th>\n",
       "      <th>EDREGTIME</th>\n",
       "      <th>EDOUTTIME</th>\n",
       "      <th>DIAGNOSIS</th>\n",
       "      <th>HOSPITAL_EXPIRE_FLAG</th>\n",
       "      <th>HAS_CHARTEVENTS_DATA</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>234</td>\n",
       "      <td>249</td>\n",
       "      <td>F</td>\n",
       "      <td>2075-03-13 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>323</td>\n",
       "      <td>158975</td>\n",
       "      <td>...</td>\n",
       "      <td>Medicare</td>\n",
       "      <td>ENGL</td>\n",
       "      <td>CATHOLIC</td>\n",
       "      <td>DIVORCED</td>\n",
       "      <td>WHITE</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>GI BLEEDING\\COLONOSCOPY</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>235</td>\n",
       "      <td>250</td>\n",
       "      <td>F</td>\n",
       "      <td>2164-12-27 00:00:00</td>\n",
       "      <td>2188-11-22 00:00:00</td>\n",
       "      <td>2188-11-22 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "      <td>324</td>\n",
       "      <td>124271</td>\n",
       "      <td>...</td>\n",
       "      <td>Self Pay</td>\n",
       "      <td>HAIT</td>\n",
       "      <td>NOT SPECIFIED</td>\n",
       "      <td>SINGLE</td>\n",
       "      <td>BLACK</td>\n",
       "      <td>2188-11-12 06:56:00</td>\n",
       "      <td>2188-11-12 10:10:00</td>\n",
       "      <td>PNEUMONIA;R/O TB</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>236</td>\n",
       "      <td>251</td>\n",
       "      <td>M</td>\n",
       "      <td>2090-03-15 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>325</td>\n",
       "      <td>117937</td>\n",
       "      <td>...</td>\n",
       "      <td>Private</td>\n",
       "      <td>NaN</td>\n",
       "      <td>OTHER</td>\n",
       "      <td>NaN</td>\n",
       "      <td>UNKNOWN/NOT SPECIFIED</td>\n",
       "      <td>2110-07-27 05:00:00</td>\n",
       "      <td>2110-07-27 07:15:00</td>\n",
       "      <td>INTRACRANIAL HEAD BLEED</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>237</td>\n",
       "      <td>252</td>\n",
       "      <td>M</td>\n",
       "      <td>2078-03-06 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>327</td>\n",
       "      <td>193470</td>\n",
       "      <td>...</td>\n",
       "      <td>Private</td>\n",
       "      <td>NaN</td>\n",
       "      <td>UNOBTAINABLE</td>\n",
       "      <td>SINGLE</td>\n",
       "      <td>WHITE</td>\n",
       "      <td>2133-08-15 01:42:00</td>\n",
       "      <td>2133-08-15 04:45:00</td>\n",
       "      <td>GASTROINTESINAL BLEED</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>238</td>\n",
       "      <td>253</td>\n",
       "      <td>F</td>\n",
       "      <td>2089-11-26 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>328</td>\n",
       "      <td>176189</td>\n",
       "      <td>...</td>\n",
       "      <td>Medicare</td>\n",
       "      <td>NaN</td>\n",
       "      <td>CATHOLIC</td>\n",
       "      <td>WIDOWED</td>\n",
       "      <td>WHITE</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>COMPLETE HEART BLOCK\\PACEMAKER IMPLANT</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 26 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   ROW_ID_x  SUBJECT_ID GENDER                  DOB                  DOD  \\\n",
       "0       234         249      F  2075-03-13 00:00:00                  NaN   \n",
       "1       235         250      F  2164-12-27 00:00:00  2188-11-22 00:00:00   \n",
       "2       236         251      M  2090-03-15 00:00:00                  NaN   \n",
       "3       237         252      M  2078-03-06 00:00:00                  NaN   \n",
       "4       238         253      F  2089-11-26 00:00:00                  NaN   \n",
       "\n",
       "              DOD_HOSP DOD_SSN  EXPIRE_FLAG  ROW_ID_y  HADM_ID  ... INSURANCE  \\\n",
       "0                  NaN     NaN            0       323   158975  ...  Medicare   \n",
       "1  2188-11-22 00:00:00     NaN            1       324   124271  ...  Self Pay   \n",
       "2                  NaN     NaN            0       325   117937  ...   Private   \n",
       "3                  NaN     NaN            0       327   193470  ...   Private   \n",
       "4                  NaN     NaN            0       328   176189  ...  Medicare   \n",
       "\n",
       "  LANGUAGE       RELIGION MARITAL_STATUS              ETHNICITY  \\\n",
       "0     ENGL       CATHOLIC       DIVORCED                  WHITE   \n",
       "1     HAIT  NOT SPECIFIED         SINGLE                  BLACK   \n",
       "2      NaN          OTHER            NaN  UNKNOWN/NOT SPECIFIED   \n",
       "3      NaN   UNOBTAINABLE         SINGLE                  WHITE   \n",
       "4      NaN       CATHOLIC        WIDOWED                  WHITE   \n",
       "\n",
       "             EDREGTIME            EDOUTTIME  \\\n",
       "0                  NaN                  NaN   \n",
       "1  2188-11-12 06:56:00  2188-11-12 10:10:00   \n",
       "2  2110-07-27 05:00:00  2110-07-27 07:15:00   \n",
       "3  2133-08-15 01:42:00  2133-08-15 04:45:00   \n",
       "4                  NaN                  NaN   \n",
       "\n",
       "                                DIAGNOSIS HOSPITAL_EXPIRE_FLAG  \\\n",
       "0                 GI BLEEDING\\COLONOSCOPY                    0   \n",
       "1                        PNEUMONIA;R/O TB                    1   \n",
       "2                 INTRACRANIAL HEAD BLEED                    0   \n",
       "3                   GASTROINTESINAL BLEED                    0   \n",
       "4  COMPLETE HEART BLOCK\\PACEMAKER IMPLANT                    0   \n",
       "\n",
       "  HAS_CHARTEVENTS_DATA  \n",
       "0                    1  \n",
       "1                    1  \n",
       "2                    1  \n",
       "3                    1  \n",
       "4                    1  \n",
       "\n",
       "[5 rows x 26 columns]"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_merge.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "dbfde729-4bad-4bd7-9320-a035cc627253",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_merge_female = df_merge[df_merge.GENDER == 'F']\n",
    "df_merge_male = df_merge[df_merge.GENDER == 'M']"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "80cd351f-068b-4841-969b-563ea94dd7f1",
   "metadata": {
    "jp-MarkdownHeadingCollapsed": true,
    "tags": []
   },
   "source": [
    "## Count Ethnicity"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "id": "e13df3c9-0d91-42c1-b474-cf4520a10ef7",
   "metadata": {},
   "outputs": [],
   "source": [
    "# total count & prob for each ethnicity\n",
    "num_rac = df_uniadm.ETHNICITY.value_counts()\n",
    "rac_prob = df_merge.groupby('ETHNICITY').size().div(len(df_merge))*100"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "id": "52fe2267-435b-4d74-bc56-92d94825b19a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ETHNICITY\n",
       "WHITE                                                       69.587274\n",
       "UNKNOWN/NOT SPECIFIED                                        8.886500\n",
       "BLACK                                                        8.303955\n",
       "ASIAN                                                        3.632846\n",
       "HISPANIC OR LATINO                                           3.529665\n",
       "OTHER                                                        2.770851\n",
       "UNABLE TO OBTAIN                                             1.691745\n",
       "PATIENT DECLINED TO ANSWER                                   1.051161\n",
       "MULTI RACE ETHNICITY                                         0.234308\n",
       "AMERICAN INDIAN/ALASKA NATIVE                                0.094583\n",
       "PORTUGUESE                                                   0.085985\n",
       "MIDDLE EASTERN                                               0.060189\n",
       "NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER                    0.032244\n",
       "CARIBBEAN ISLAND                                             0.017197\n",
       "SOUTH AMERICAN                                               0.017197\n",
       "AMERICAN INDIAN/ALASKA NATIVE FEDERALLY RECOGNIZED TRIBE     0.004299\n",
       "dtype: float64"
      ]
     },
     "execution_count": 22,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "rac_prob.sort_values(ascending=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "7a2cba5e-c5ab-44e3-b206-f20e6136814d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "WHITE                                                       32372\n",
       "UNKNOWN/NOT SPECIFIED                                        4134\n",
       "BLACK                                                        3863\n",
       "ASIAN                                                        1690\n",
       "HISPANIC OR LATINO                                           1642\n",
       "OTHER                                                        1289\n",
       "UNABLE TO OBTAIN                                              787\n",
       "PATIENT DECLINED TO ANSWER                                    489\n",
       "MULTI RACE ETHNICITY                                          109\n",
       "AMERICAN INDIAN/ALASKA NATIVE                                  44\n",
       "PORTUGUESE                                                     40\n",
       "MIDDLE EASTERN                                                 28\n",
       "NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER                      15\n",
       "SOUTH AMERICAN                                                  8\n",
       "CARIBBEAN ISLAND                                                8\n",
       "AMERICAN INDIAN/ALASKA NATIVE FEDERALLY RECOGNIZED TRIBE        2\n",
       "Name: ETHNICITY, dtype: int64"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "num_rac"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "adb86b5d-7d2c-4866-b86e-a23d0f5fdb71",
   "metadata": {},
   "outputs": [],
   "source": [
    "# total count for ethnicity in female\n",
    "num_rac_F = df_merge_female.ETHNICITY.value_counts()\n",
    "rac_female_prob = df_merge_female.groupby('ETHNICITY').size().div(len(df_merge_female))*100"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "52e1716a-a6a4-4897-b9dd-517cdc73d892",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ETHNICITY\n",
       "WHITE                                                       69.106329\n",
       "BLACK                                                       10.054414\n",
       "UNKNOWN/NOT SPECIFIED                                        8.343546\n",
       "ASIAN                                                        3.647238\n",
       "HISPANIC OR LATINO                                           3.235453\n",
       "OTHER                                                        2.480514\n",
       "UNABLE TO OBTAIN                                             1.583411\n",
       "PATIENT DECLINED TO ANSWER                                   1.004951\n",
       "MULTI RACE ETHNICITY                                         0.245110\n",
       "AMERICAN INDIAN/ALASKA NATIVE                                0.093142\n",
       "PORTUGUESE                                                   0.093142\n",
       "MIDDLE EASTERN                                               0.044120\n",
       "NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER                    0.034315\n",
       "SOUTH AMERICAN                                               0.019609\n",
       "CARIBBEAN ISLAND                                             0.009804\n",
       "AMERICAN INDIAN/ALASKA NATIVE FEDERALLY RECOGNIZED TRIBE     0.004902\n",
       "dtype: float64"
      ]
     },
     "execution_count": 25,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "rac_female_prob.sort_values(ascending=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "0de8f39a-d5c3-4197-a863-e50160d4b2ef",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "WHITE                                                       14097\n",
       "BLACK                                                        2051\n",
       "UNKNOWN/NOT SPECIFIED                                        1702\n",
       "ASIAN                                                         744\n",
       "HISPANIC OR LATINO                                            660\n",
       "OTHER                                                         506\n",
       "UNABLE TO OBTAIN                                              323\n",
       "PATIENT DECLINED TO ANSWER                                    205\n",
       "MULTI RACE ETHNICITY                                           50\n",
       "AMERICAN INDIAN/ALASKA NATIVE                                  19\n",
       "PORTUGUESE                                                     19\n",
       "MIDDLE EASTERN                                                  9\n",
       "NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER                       7\n",
       "SOUTH AMERICAN                                                  4\n",
       "CARIBBEAN ISLAND                                                2\n",
       "AMERICAN INDIAN/ALASKA NATIVE FEDERALLY RECOGNIZED TRIBE        1\n",
       "Name: ETHNICITY, dtype: int64"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "num_rac_F"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "id": "02e83dd8-7490-4c10-898e-32dbac226a4c",
   "metadata": {},
   "outputs": [],
   "source": [
    "# total count for ethnicity in male\n",
    "num_rac_M = df_merge_male.ETHNICITY.value_counts()\n",
    "rac_male_prob = df_merge_male.groupby('ETHNICITY').size().div(len(df_merge_male))*100"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "5f236614-d857-43e6-bd15-562c233b5722",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ETHNICITY\n",
       "WHITE                                                       69.962865\n",
       "UNKNOWN/NOT SPECIFIED                                        9.310516\n",
       "BLACK                                                        6.936947\n",
       "HISPANIC OR LATINO                                           3.759427\n",
       "ASIAN                                                        3.621607\n",
       "OTHER                                                        2.997588\n",
       "UNABLE TO OBTAIN                                             1.776349\n",
       "PATIENT DECLINED TO ANSWER                                   1.087248\n",
       "MULTI RACE ETHNICITY                                         0.225872\n",
       "AMERICAN INDIAN/ALASKA NATIVE                                0.095708\n",
       "PORTUGUESE                                                   0.080395\n",
       "MIDDLE EASTERN                                               0.072738\n",
       "NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER                    0.030627\n",
       "CARIBBEAN ISLAND                                             0.022970\n",
       "SOUTH AMERICAN                                               0.015313\n",
       "AMERICAN INDIAN/ALASKA NATIVE FEDERALLY RECOGNIZED TRIBE     0.003828\n",
       "dtype: float64"
      ]
     },
     "execution_count": 28,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "rac_male_prob.sort_values(ascending=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "id": "29f25f58-19bb-4288-80ff-77a4f3787a14",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "WHITE                                                       18275\n",
       "UNKNOWN/NOT SPECIFIED                                        2432\n",
       "BLACK                                                        1812\n",
       "HISPANIC OR LATINO                                            982\n",
       "ASIAN                                                         946\n",
       "OTHER                                                         783\n",
       "UNABLE TO OBTAIN                                              464\n",
       "PATIENT DECLINED TO ANSWER                                    284\n",
       "MULTI RACE ETHNICITY                                           59\n",
       "AMERICAN INDIAN/ALASKA NATIVE                                  25\n",
       "PORTUGUESE                                                     21\n",
       "MIDDLE EASTERN                                                 19\n",
       "NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER                       8\n",
       "CARIBBEAN ISLAND                                                6\n",
       "SOUTH AMERICAN                                                  4\n",
       "AMERICAN INDIAN/ALASKA NATIVE FEDERALLY RECOGNIZED TRIBE        1\n",
       "Name: ETHNICITY, dtype: int64"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "num_rac_M"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0ce3bad4-fc4f-4285-acca-0e7035baafd2",
   "metadata": {
    "jp-MarkdownHeadingCollapsed": true,
    "tags": []
   },
   "source": [
    "## Count Admission Type"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "b1b41d1f-11b8-4a94-862e-e84119daac78",
   "metadata": {},
   "outputs": [],
   "source": [
    "# total number of admission\n",
    "num_adm = df_uniadm.ADMISSION_TYPE.value_counts()\n",
    "adm_prob = df_merge.groupby('ADMISSION_TYPE').size().div(len(df_merge))*100"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "7a633e86-4a64-4a8b-8962-2258c339befc",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ADMISSION_TYPE\n",
       "ELECTIVE     12.996561\n",
       "EMERGENCY    68.372743\n",
       "NEWBORN      16.407997\n",
       "URGENT        2.222700\n",
       "dtype: float64"
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "adm_prob"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "id": "1829b3ba-0ecd-473b-a387-85b946152ef8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "EMERGENCY    13983\n",
       "NEWBORN       3510\n",
       "ELECTIVE      2436\n",
       "URGENT         470\n",
       "Name: ADMISSION_TYPE, dtype: int64"
      ]
     },
     "execution_count": 32,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# total number of admission in female\n",
    "num_adm_F = df_merge_female.ADMISSION_TYPE.value_counts()\n",
    "adm_female_prob = df_merge_female.groupby('ADMISSION_TYPE').size().div(len(df_merge_female))*100\n",
    "num_adm_F"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "id": "f994b58e-542e-4c2a-86d0-1ba4e7b316f4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ADMISSION_TYPE\n",
       "ELECTIVE     11.941762\n",
       "EMERGENCY    68.547478\n",
       "NEWBORN      17.206726\n",
       "URGENT        2.304035\n",
       "dtype: float64"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "adm_female_prob"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "ecd44681-3f4f-40e2-8839-862248de1bde",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "EMERGENCY    17824\n",
       "NEWBORN       4123\n",
       "ELECTIVE      3610\n",
       "URGENT         564\n",
       "Name: ADMISSION_TYPE, dtype: int64"
      ]
     },
     "execution_count": 34,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# total number of admission in male\n",
    "num_adm_M = df_merge_male.ADMISSION_TYPE.value_counts()\n",
    "adm_male_prob = df_merge_male.groupby('ADMISSION_TYPE').size().div(len(df_merge_male))*100\n",
    "num_adm_M"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "ee562110-d0fa-4cec-9a42-cc50d88a1664",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ADMISSION_TYPE\n",
       "ELECTIVE     13.820298\n",
       "EMERGENCY    68.236285\n",
       "NEWBORN      15.784235\n",
       "URGENT        2.159182\n",
       "dtype: float64"
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "adm_male_prob"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "220b31cf-0018-4ca1-9090-f45d3bf8e128",
   "metadata": {
    "jp-MarkdownHeadingCollapsed": true,
    "tags": []
   },
   "source": [
    "## Count Marital status"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "id": "c01517e3-0ac0-451d-852e-65d2a761dee0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "MARRIED              18492\n",
       "SINGLE                9767\n",
       "WIDOWED               5462\n",
       "DIVORCED              2331\n",
       "SEPARATED              384\n",
       "UNKNOWN (DEFAULT)      307\n",
       "LIFE PARTNER            13\n",
       "Name: MARITAL_STATUS, dtype: int64"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# total number of marital status\n",
    "num_mar = df_uniadm.MARITAL_STATUS.value_counts()\n",
    "mar_prob = df_uniadm.groupby('MARITAL_STATUS').size().div(len(df_uniadm))*100\n",
    "num_mar"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "id": "f902e3da-89e9-467a-aab0-085d452e37ce",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "MARITAL_STATUS\n",
       "MARRIED              39.750645\n",
       "SINGLE               20.995271\n",
       "WIDOWED              11.741187\n",
       "DIVORCED              5.010748\n",
       "SEPARATED             0.825451\n",
       "UNKNOWN (DEFAULT)     0.659931\n",
       "LIFE PARTNER          0.027945\n",
       "dtype: float64"
      ]
     },
     "execution_count": 37,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mar_prob.sort_values(ascending=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 38,
   "id": "789aa02e-d0d5-46c7-8842-2a45cd7fd721",
   "metadata": {},
   "outputs": [],
   "source": [
    "# total number of marital status in female"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "id": "995435bb-7611-4478-a1e7-4c06197b353f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "MARRIED              6192\n",
       "SINGLE               4154\n",
       "WIDOWED              4065\n",
       "DIVORCED             1219\n",
       "SEPARATED             212\n",
       "UNKNOWN (DEFAULT)     154\n",
       "LIFE PARTNER            5\n",
       "Name: MARITAL_STATUS, dtype: int64"
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "num_mar_F = df_merge_female.MARITAL_STATUS.value_counts()\n",
    "mar_female_prob = df_merge_female.groupby('MARITAL_STATUS').size().div(len(df_merge_female))*100\n",
    "num_mar_F"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "id": "67f2d45f-2689-4e8a-9e54-b03a853641b8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "MARITAL_STATUS\n",
       "MARRIED              30.354429\n",
       "SINGLE               20.363743\n",
       "WIDOWED              19.927447\n",
       "DIVORCED              5.975783\n",
       "SEPARATED             1.039267\n",
       "UNKNOWN (DEFAULT)     0.754939\n",
       "LIFE PARTNER          0.024511\n",
       "dtype: float64"
      ]
     },
     "execution_count": 40,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mar_female_prob.sort_values(ascending=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "id": "61a2f77e-72cc-4560-95f4-a0c07f042281",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "MARRIED              12300\n",
       "SINGLE                5613\n",
       "WIDOWED               1397\n",
       "DIVORCED              1112\n",
       "SEPARATED              172\n",
       "UNKNOWN (DEFAULT)      153\n",
       "LIFE PARTNER             8\n",
       "Name: MARITAL_STATUS, dtype: int64"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# total number of marital status in male\n",
    "num_mar_M = df_merge_male.MARITAL_STATUS.value_counts()\n",
    "mar_male_prob = df_merge_male.groupby('MARITAL_STATUS').size().div(len(df_merge_male))*100\n",
    "num_mar_M"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "id": "6c2618d6-41a1-4efb-b13a-2b2c65bcd9f9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "MARITAL_STATUS\n",
       "MARRIED              47.088549\n",
       "SINGLE               21.488458\n",
       "WIDOWED               5.348187\n",
       "DIVORCED              4.257111\n",
       "SEPARATED             0.658474\n",
       "UNKNOWN (DEFAULT)     0.585736\n",
       "LIFE PARTNER          0.030627\n",
       "dtype: float64"
      ]
     },
     "execution_count": 42,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "mar_male_prob.sort_values(ascending=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "aff77061-0ede-481a-a8b6-4dd3123034e8",
   "metadata": {
    "jp-MarkdownHeadingCollapsed": true,
    "tags": []
   },
   "source": [
    "# Calculate Age "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "id": "027de167-25ea-4383-9d2b-61c52dc5a455",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ROW_ID_x</th>\n",
       "      <th>SUBJECT_ID</th>\n",
       "      <th>HADM_ID</th>\n",
       "      <th>ADMITTIME</th>\n",
       "      <th>DISCHTIME</th>\n",
       "      <th>DEATHTIME</th>\n",
       "      <th>ADMISSION_TYPE</th>\n",
       "      <th>ADMISSION_LOCATION</th>\n",
       "      <th>DISCHARGE_LOCATION</th>\n",
       "      <th>INSURANCE</th>\n",
       "      <th>...</th>\n",
       "      <th>DIAGNOSIS</th>\n",
       "      <th>HOSPITAL_EXPIRE_FLAG</th>\n",
       "      <th>HAS_CHARTEVENTS_DATA</th>\n",
       "      <th>ROW_ID_y</th>\n",
       "      <th>GENDER</th>\n",
       "      <th>DOB</th>\n",
       "      <th>DOD</th>\n",
       "      <th>DOD_HOSP</th>\n",
       "      <th>DOD_SSN</th>\n",
       "      <th>EXPIRE_FLAG</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>58971</th>\n",
       "      <td>58592</td>\n",
       "      <td>98794</td>\n",
       "      <td>190603</td>\n",
       "      <td>2127-11-07 11:00:00</td>\n",
       "      <td>2127-11-11 14:30:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ELECTIVE</td>\n",
       "      <td>PHYS REFERRAL/NORMAL DELI</td>\n",
       "      <td>HOME HEALTH CARE</td>\n",
       "      <td>Medicare</td>\n",
       "      <td>...</td>\n",
       "      <td>AORTIC STENOSIS\\AORTIC VALVE REPLACEMENT /SDA</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>46211</td>\n",
       "      <td>M</td>\n",
       "      <td>2049-07-29 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58972</th>\n",
       "      <td>58593</td>\n",
       "      <td>98797</td>\n",
       "      <td>105447</td>\n",
       "      <td>2132-12-24 20:06:00</td>\n",
       "      <td>2132-12-25 12:00:00</td>\n",
       "      <td>2132-12-25 12:00:00</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>EMERGENCY ROOM ADMIT</td>\n",
       "      <td>DEAD/EXPIRED</td>\n",
       "      <td>Medicare</td>\n",
       "      <td>...</td>\n",
       "      <td>ALTERED MENTAL STATUS</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>46212</td>\n",
       "      <td>M</td>\n",
       "      <td>2044-12-27 00:00:00</td>\n",
       "      <td>2132-12-25 00:00:00</td>\n",
       "      <td>2132-12-25 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58973</th>\n",
       "      <td>58594</td>\n",
       "      <td>98800</td>\n",
       "      <td>191113</td>\n",
       "      <td>2131-03-30 21:13:00</td>\n",
       "      <td>2131-04-02 15:02:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>CLINIC REFERRAL/PREMATURE</td>\n",
       "      <td>HOME</td>\n",
       "      <td>Private</td>\n",
       "      <td>...</td>\n",
       "      <td>TRAUMA</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>46213</td>\n",
       "      <td>F</td>\n",
       "      <td>2111-11-05 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58974</th>\n",
       "      <td>58595</td>\n",
       "      <td>98802</td>\n",
       "      <td>101071</td>\n",
       "      <td>2151-03-05 20:00:00</td>\n",
       "      <td>2151-03-06 09:10:00</td>\n",
       "      <td>2151-03-06 09:10:00</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>CLINIC REFERRAL/PREMATURE</td>\n",
       "      <td>DEAD/EXPIRED</td>\n",
       "      <td>Medicare</td>\n",
       "      <td>...</td>\n",
       "      <td>SAH</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>46214</td>\n",
       "      <td>F</td>\n",
       "      <td>2067-09-21 00:00:00</td>\n",
       "      <td>2151-03-06 00:00:00</td>\n",
       "      <td>2151-03-06 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>58975</th>\n",
       "      <td>58596</td>\n",
       "      <td>98805</td>\n",
       "      <td>122631</td>\n",
       "      <td>2200-09-12 07:15:00</td>\n",
       "      <td>2200-09-20 12:08:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ELECTIVE</td>\n",
       "      <td>PHYS REFERRAL/NORMAL DELI</td>\n",
       "      <td>HOME HEALTH CARE</td>\n",
       "      <td>Private</td>\n",
       "      <td>...</td>\n",
       "      <td>RENAL CANCER/SDA</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>46215</td>\n",
       "      <td>M</td>\n",
       "      <td>2158-03-02 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 26 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "       ROW_ID_x  SUBJECT_ID  HADM_ID            ADMITTIME  \\\n",
       "58971     58592       98794   190603  2127-11-07 11:00:00   \n",
       "58972     58593       98797   105447  2132-12-24 20:06:00   \n",
       "58973     58594       98800   191113  2131-03-30 21:13:00   \n",
       "58974     58595       98802   101071  2151-03-05 20:00:00   \n",
       "58975     58596       98805   122631  2200-09-12 07:15:00   \n",
       "\n",
       "                 DISCHTIME            DEATHTIME ADMISSION_TYPE  \\\n",
       "58971  2127-11-11 14:30:00                  NaN       ELECTIVE   \n",
       "58972  2132-12-25 12:00:00  2132-12-25 12:00:00      EMERGENCY   \n",
       "58973  2131-04-02 15:02:00                  NaN      EMERGENCY   \n",
       "58974  2151-03-06 09:10:00  2151-03-06 09:10:00      EMERGENCY   \n",
       "58975  2200-09-20 12:08:00                  NaN       ELECTIVE   \n",
       "\n",
       "              ADMISSION_LOCATION DISCHARGE_LOCATION INSURANCE  ...  \\\n",
       "58971  PHYS REFERRAL/NORMAL DELI   HOME HEALTH CARE  Medicare  ...   \n",
       "58972       EMERGENCY ROOM ADMIT       DEAD/EXPIRED  Medicare  ...   \n",
       "58973  CLINIC REFERRAL/PREMATURE               HOME   Private  ...   \n",
       "58974  CLINIC REFERRAL/PREMATURE       DEAD/EXPIRED  Medicare  ...   \n",
       "58975  PHYS REFERRAL/NORMAL DELI   HOME HEALTH CARE   Private  ...   \n",
       "\n",
       "                                           DIAGNOSIS HOSPITAL_EXPIRE_FLAG  \\\n",
       "58971  AORTIC STENOSIS\\AORTIC VALVE REPLACEMENT /SDA                    0   \n",
       "58972                          ALTERED MENTAL STATUS                    1   \n",
       "58973                                         TRAUMA                    0   \n",
       "58974                                            SAH                    1   \n",
       "58975                               RENAL CANCER/SDA                    0   \n",
       "\n",
       "      HAS_CHARTEVENTS_DATA ROW_ID_y GENDER                  DOB  \\\n",
       "58971                    1    46211      M  2049-07-29 00:00:00   \n",
       "58972                    1    46212      M  2044-12-27 00:00:00   \n",
       "58973                    1    46213      F  2111-11-05 00:00:00   \n",
       "58974                    1    46214      F  2067-09-21 00:00:00   \n",
       "58975                    1    46215      M  2158-03-02 00:00:00   \n",
       "\n",
       "                       DOD             DOD_HOSP  DOD_SSN  EXPIRE_FLAG  \n",
       "58971                  NaN                  NaN      NaN            0  \n",
       "58972  2132-12-25 00:00:00  2132-12-25 00:00:00      NaN            1  \n",
       "58973                  NaN                  NaN      NaN            0  \n",
       "58974  2151-03-06 00:00:00  2151-03-06 00:00:00      NaN            1  \n",
       "58975                  NaN                  NaN      NaN            0  \n",
       "\n",
       "[5 rows x 26 columns]"
      ]
     },
     "execution_count": 43,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "adm_age = pd.merge( df_adm , df_pat, how='inner', on='SUBJECT_ID')\n",
    "adm_age.tail(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "id": "03032599-3b3f-4e9f-ad16-241a01b6a202",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(58976, 26)"
      ]
     },
     "execution_count": 44,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "adm_age.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "id": "41c222f0-371a-4c7b-a61b-0fe8213c9382",
   "metadata": {},
   "outputs": [],
   "source": [
    "adm_age['ADMITTIME'] = pd.to_datetime(adm_age['ADMITTIME']).dt.date\n",
    "adm_age['DISCHTIME'] = pd.to_datetime(adm_age['DISCHTIME']).dt.date\n",
    "\n",
    "adm_age['DOB'] = pd.to_datetime(adm_age['DOB']).dt.date\n",
    "\n",
    "adm_age['AGE'] = (adm_age['ADMITTIME']-adm_age['DOB']).apply(lambda x: int(x.days/365))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "id": "b432da16-f2b5-442d-8ded-50f18fc3e679",
   "metadata": {},
   "outputs": [],
   "source": [
    "adm_age = adm_age.drop(['ROW_ID_x', 'ROW_ID_y'], axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "id": "06e130d0-6ccc-432f-8790-a33084278dc8",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Add admit times\n",
    "adm_age['ADMIT_TIMES'] = adm_age.groupby('SUBJECT_ID').SUBJECT_ID.transform('count')\n",
    "# Add length stay\n",
    "adm_age['LENGTH_STAY'] = (adm_age['DISCHTIME'] - adm_age['ADMITTIME']).apply(lambda x: int(x.days))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "36f8ac80-7f4a-4dbb-9904-fd288d24ac15",
   "metadata": {
    "tags": []
   },
   "source": [
    "# Filter Out VTE"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 48,
   "id": "10397fb2-68f3-4841-a29c-25156c6fb38a",
   "metadata": {},
   "outputs": [],
   "source": [
    "lista = ['4511', '4512', '45181', '4534', '4535', '45183', '45184', '45189', '45372', '45373', '45374', '45375', '45376', '45377', '45382', '45383', '45384', '45385', '45386', '45387', '4510', '4519', '4520', '4530', '4530', '4531', '4532', '4533', '45379', '4538', '45389', '4539']\n",
    "df_vte = df_dia_icd.loc[df_dia_icd['ICD9_CODE'].isin(lista)]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ff8e684b-4cd1-4a44-ab69-e3276b8df67a",
   "metadata": {
    "tags": []
   },
   "source": [
    "# df_vte.shape"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "1db40d92-6e66-4cbe-b6aa-7c59f84c7948",
   "metadata": {
    "tags": []
   },
   "source": [
    "## Merge admission_age df and vte df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 49,
   "id": "7c52053e-f3e3-4f73-9ca4-1331e1f648a9",
   "metadata": {},
   "outputs": [],
   "source": [
    "vte_adm = pd.merge(df_vte, adm_age, how='inner', on=['SUBJECT_ID', 'HADM_ID'])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ffb2a11c-e60c-46fc-9705-e067529c104c",
   "metadata": {
    "tags": []
   },
   "source": [
    "#### Gender Count in total"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "2cda8a97-25f2-4b79-bfef-ecd3b05d2424",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "M    652\n",
       "F    501\n",
       "Name: GENDER, dtype: int64"
      ]
     },
     "execution_count": 50,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vte_adm.GENDER.value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "f9c77f4b-a9c6-4cb4-b8a8-29030ec3d858",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(1153, 30)"
      ]
     },
     "execution_count": 51,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vte_adm.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "5db167eb-21ba-4618-9f2a-c709930ac633",
   "metadata": {},
   "outputs": [],
   "source": [
    "vte_adm = vte_adm.sort_values(by='AGE')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "cf675cad-cfe0-4d75-beb0-81a02b2f338b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>ROW_ID</th>\n",
       "      <th>SUBJECT_ID</th>\n",
       "      <th>HADM_ID</th>\n",
       "      <th>SEQ_NUM</th>\n",
       "      <th>ICD9_CODE</th>\n",
       "      <th>ADMITTIME</th>\n",
       "      <th>DISCHTIME</th>\n",
       "      <th>DEATHTIME</th>\n",
       "      <th>ADMISSION_TYPE</th>\n",
       "      <th>ADMISSION_LOCATION</th>\n",
       "      <th>...</th>\n",
       "      <th>HAS_CHARTEVENTS_DATA</th>\n",
       "      <th>GENDER</th>\n",
       "      <th>DOB</th>\n",
       "      <th>DOD</th>\n",
       "      <th>DOD_HOSP</th>\n",
       "      <th>DOD_SSN</th>\n",
       "      <th>EXPIRE_FLAG</th>\n",
       "      <th>AGE</th>\n",
       "      <th>ADMIT_TIMES</th>\n",
       "      <th>LENGTH_STAY</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>10124</td>\n",
       "      <td>873</td>\n",
       "      <td>162837</td>\n",
       "      <td>5.0</td>\n",
       "      <td>4532</td>\n",
       "      <td>2134-02-24</td>\n",
       "      <td>2134-03-26</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NEWBORN</td>\n",
       "      <td>CLINIC REFERRAL/PREMATURE</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>M</td>\n",
       "      <td>2134-02-24</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>10126</td>\n",
       "      <td>873</td>\n",
       "      <td>162837</td>\n",
       "      <td>7.0</td>\n",
       "      <td>4533</td>\n",
       "      <td>2134-02-24</td>\n",
       "      <td>2134-03-26</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NEWBORN</td>\n",
       "      <td>CLINIC REFERRAL/PREMATURE</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>M</td>\n",
       "      <td>2134-02-24</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>30</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>718</th>\n",
       "      <td>363667</td>\n",
       "      <td>31597</td>\n",
       "      <td>131426</td>\n",
       "      <td>11.0</td>\n",
       "      <td>4519</td>\n",
       "      <td>2199-05-27</td>\n",
       "      <td>2199-09-02</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NEWBORN</td>\n",
       "      <td>CLINIC REFERRAL/PREMATURE</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>M</td>\n",
       "      <td>2199-05-27</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>98</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>135</th>\n",
       "      <td>75190</td>\n",
       "      <td>6732</td>\n",
       "      <td>152060</td>\n",
       "      <td>2.0</td>\n",
       "      <td>4538</td>\n",
       "      <td>2197-11-02</td>\n",
       "      <td>2197-11-09</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ELECTIVE</td>\n",
       "      <td>PHYS REFERRAL/NORMAL DELI</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>F</td>\n",
       "      <td>2180-06-01</td>\n",
       "      <td>2198-04-02 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2198-04-02 00:00:00</td>\n",
       "      <td>1</td>\n",
       "      <td>17</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>134</th>\n",
       "      <td>75189</td>\n",
       "      <td>6732</td>\n",
       "      <td>152060</td>\n",
       "      <td>1.0</td>\n",
       "      <td>4532</td>\n",
       "      <td>2197-11-02</td>\n",
       "      <td>2197-11-09</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ELECTIVE</td>\n",
       "      <td>PHYS REFERRAL/NORMAL DELI</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>F</td>\n",
       "      <td>2180-06-01</td>\n",
       "      <td>2198-04-02 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2198-04-02 00:00:00</td>\n",
       "      <td>1</td>\n",
       "      <td>17</td>\n",
       "      <td>1</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 30 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "     ROW_ID  SUBJECT_ID  HADM_ID  SEQ_NUM ICD9_CODE   ADMITTIME   DISCHTIME  \\\n",
       "27    10124         873   162837      5.0      4532  2134-02-24  2134-03-26   \n",
       "28    10126         873   162837      7.0      4533  2134-02-24  2134-03-26   \n",
       "718  363667       31597   131426     11.0      4519  2199-05-27  2199-09-02   \n",
       "135   75190        6732   152060      2.0      4538  2197-11-02  2197-11-09   \n",
       "134   75189        6732   152060      1.0      4532  2197-11-02  2197-11-09   \n",
       "\n",
       "    DEATHTIME ADMISSION_TYPE         ADMISSION_LOCATION  ...  \\\n",
       "27        NaN        NEWBORN  CLINIC REFERRAL/PREMATURE  ...   \n",
       "28        NaN        NEWBORN  CLINIC REFERRAL/PREMATURE  ...   \n",
       "718       NaN        NEWBORN  CLINIC REFERRAL/PREMATURE  ...   \n",
       "135       NaN       ELECTIVE  PHYS REFERRAL/NORMAL DELI  ...   \n",
       "134       NaN       ELECTIVE  PHYS REFERRAL/NORMAL DELI  ...   \n",
       "\n",
       "    HAS_CHARTEVENTS_DATA GENDER         DOB                  DOD DOD_HOSP  \\\n",
       "27                     1      M  2134-02-24                  NaN      NaN   \n",
       "28                     1      M  2134-02-24                  NaN      NaN   \n",
       "718                    1      M  2199-05-27                  NaN      NaN   \n",
       "135                    1      F  2180-06-01  2198-04-02 00:00:00      NaN   \n",
       "134                    1      F  2180-06-01  2198-04-02 00:00:00      NaN   \n",
       "\n",
       "                 DOD_SSN EXPIRE_FLAG AGE ADMIT_TIMES  LENGTH_STAY  \n",
       "27                   NaN           0   0           1           30  \n",
       "28                   NaN           0   0           1           30  \n",
       "718                  NaN           0   0           1           98  \n",
       "135  2198-04-02 00:00:00           1  17           1            7  \n",
       "134  2198-04-02 00:00:00           1  17           1            7  \n",
       "\n",
       "[5 rows x 30 columns]"
      ]
     },
     "execution_count": 53,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vte_adm.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "id": "c8e29f7d-c804-4d51-9239-682a2288632d",
   "metadata": {},
   "outputs": [],
   "source": [
    "condition = [((vte_adm['AGE']>=0) & (vte_adm['AGE']<=9)),\n",
    "            ((vte_adm['AGE']>=10) & (vte_adm['AGE']<=19)),\n",
    "            ((vte_adm['AGE']>=20) & (vte_adm['AGE']<=29)),\n",
    "            ((vte_adm['AGE']>=30) & (vte_adm['AGE']<=39)),\n",
    "            ((vte_adm['AGE']>=40) & (vte_adm['AGE']<=49)),\n",
    "            ((vte_adm['AGE']>=50) & (vte_adm['AGE']<=59)),\n",
    "            ((vte_adm['AGE']>=60) & (vte_adm['AGE']<=69)),\n",
    "            ((vte_adm['AGE']>=70) & (vte_adm['AGE']<=79)),\n",
    "            ((vte_adm['AGE']>=80) & (vte_adm['AGE']<=89)),\n",
    "            (vte_adm['AGE'] > 89)]\n",
    "\n",
    "age_range = ['[0-9]', '[10-19]', '[20-29]', '[30-39]', '[40-49]', '[50-59]', '[60-69]', '[70-79]', '[80-89]', '[89+]']\n",
    "\n",
    "vte_adm['AGE_RANGE'] = np.select(condition, age_range)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "id": "939d9066-b424-4fb6-9eca-c955daca249a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "AGE_RANGE\n",
       "[0-9]        3\n",
       "[10-19]      8\n",
       "[20-29]     33\n",
       "[30-39]     72\n",
       "[40-49]    132\n",
       "[50-59]    224\n",
       "[60-69]    249\n",
       "[70-79]    243\n",
       "[80-89]    153\n",
       "[89+]       36\n",
       "dtype: int64"
      ]
     },
     "execution_count": 55,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vte_adm.groupby('AGE_RANGE').size()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "id": "10bd81af-0a87-4f83-a6e7-eb2bab516f28",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    1153.000000\n",
       "mean       68.940156\n",
       "std        44.486586\n",
       "min         0.000000\n",
       "25%        51.000000\n",
       "50%        64.000000\n",
       "75%        76.000000\n",
       "max       307.000000\n",
       "Name: AGE, dtype: float64"
      ]
     },
     "execution_count": 56,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vte_adm['AGE'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "29261f43-d88c-4d40-b521-8a8b331e4e9f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    501.000000\n",
       "mean      71.315369\n",
       "std       49.533750\n",
       "min       17.000000\n",
       "25%       51.000000\n",
       "50%       66.000000\n",
       "75%       76.000000\n",
       "max      307.000000\n",
       "Name: AGE, dtype: float64"
      ]
     },
     "execution_count": 57,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Female\n",
    "vte_adm['AGE'][vte_adm['GENDER'] == 'F'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 58,
   "id": "6d0c8abc-9b45-483e-8e01-20ed33ecb9ab",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    652.000000\n",
       "mean      67.115031\n",
       "std       40.124200\n",
       "min        0.000000\n",
       "25%       51.750000\n",
       "50%       63.000000\n",
       "75%       75.000000\n",
       "max      302.000000\n",
       "Name: AGE, dtype: float64"
      ]
     },
     "execution_count": 58,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Male\n",
    "vte_adm['AGE'][vte_adm['GENDER'] == 'M'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 59,
   "id": "a201b8f4-8a2e-4032-8a61-30c56bf5d01a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    1153.000000\n",
       "mean        2.267997\n",
       "std         2.630977\n",
       "min         1.000000\n",
       "25%         1.000000\n",
       "50%         1.000000\n",
       "75%         2.000000\n",
       "max        34.000000\n",
       "Name: ADMIT_TIMES, dtype: float64"
      ]
     },
     "execution_count": 59,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vte_adm['ADMIT_TIMES'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 60,
   "id": "fda3a1f7-4948-497f-8403-790e43c8a440",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    501.000000\n",
       "mean       2.357285\n",
       "std        3.172710\n",
       "min        1.000000\n",
       "25%        1.000000\n",
       "50%        1.000000\n",
       "75%        2.000000\n",
       "max       34.000000\n",
       "Name: ADMIT_TIMES, dtype: float64"
      ]
     },
     "execution_count": 60,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Female\n",
    "vte_adm['ADMIT_TIMES'][vte_adm['GENDER'] == 'F'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 61,
   "id": "be443c69-54c1-4360-bb83-75b3c7ae62d9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    652.000000\n",
       "mean       2.199387\n",
       "std        2.122978\n",
       "min        1.000000\n",
       "25%        1.000000\n",
       "50%        1.000000\n",
       "75%        2.000000\n",
       "max       16.000000\n",
       "Name: ADMIT_TIMES, dtype: float64"
      ]
     },
     "execution_count": 61,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Male\n",
    "vte_adm['ADMIT_TIMES'][vte_adm['GENDER'] == 'M'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 62,
   "id": "354a915d-f2fd-4770-b85d-e8a9829907eb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    1153.000000\n",
       "mean       18.501301\n",
       "std        18.526263\n",
       "min         0.000000\n",
       "25%         8.000000\n",
       "50%        14.000000\n",
       "75%        22.000000\n",
       "max       182.000000\n",
       "Name: LENGTH_STAY, dtype: float64"
      ]
     },
     "execution_count": 62,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vte_adm['LENGTH_STAY'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 63,
   "id": "27891e3b-672d-48d7-bf1b-647c51044e99",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    501.000000\n",
       "mean      17.720559\n",
       "std       15.829143\n",
       "min        0.000000\n",
       "25%        8.000000\n",
       "50%       14.000000\n",
       "75%       21.000000\n",
       "max      182.000000\n",
       "Name: LENGTH_STAY, dtype: float64"
      ]
     },
     "execution_count": 63,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#Female\n",
    "vte_adm['LENGTH_STAY'][vte_adm['GENDER'] == 'F'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 64,
   "id": "5b8ad41a-445a-401b-8626-3eec689f0534",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    652.000000\n",
       "mean      19.101227\n",
       "std       20.349153\n",
       "min        0.000000\n",
       "25%        8.000000\n",
       "50%       14.000000\n",
       "75%       22.250000\n",
       "max      174.000000\n",
       "Name: LENGTH_STAY, dtype: float64"
      ]
     },
     "execution_count": 64,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Male\n",
    "vte_adm['LENGTH_STAY'][vte_adm['GENDER'] == 'M'].describe()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2f9ffa65-98e3-4999-9553-ac5f47b63417",
   "metadata": {
    "tags": []
   },
   "source": [
    "# All Patients Who Was Readmitted Within 30 days"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "id": "c541bbe4-c38c-4d02-9866-d0f118356ca5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>SUBJECT_ID</th>\n",
       "      <th>HADM_ID</th>\n",
       "      <th>ADMITTIME</th>\n",
       "      <th>DISCHTIME</th>\n",
       "      <th>DEATHTIME</th>\n",
       "      <th>ADMISSION_TYPE</th>\n",
       "      <th>ADMISSION_LOCATION</th>\n",
       "      <th>DISCHARGE_LOCATION</th>\n",
       "      <th>INSURANCE</th>\n",
       "      <th>LANGUAGE</th>\n",
       "      <th>...</th>\n",
       "      <th>HAS_CHARTEVENTS_DATA</th>\n",
       "      <th>GENDER</th>\n",
       "      <th>DOB</th>\n",
       "      <th>DOD</th>\n",
       "      <th>DOD_HOSP</th>\n",
       "      <th>DOD_SSN</th>\n",
       "      <th>EXPIRE_FLAG</th>\n",
       "      <th>AGE</th>\n",
       "      <th>ADMIT_TIMES</th>\n",
       "      <th>LENGTH_STAY</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>22</td>\n",
       "      <td>165315</td>\n",
       "      <td>2196-04-09</td>\n",
       "      <td>2196-04-10</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>EMERGENCY ROOM ADMIT</td>\n",
       "      <td>DISC-TRAN CANCER/CHLDRN H</td>\n",
       "      <td>Private</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>F</td>\n",
       "      <td>2131-05-07</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>64</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>23</td>\n",
       "      <td>152223</td>\n",
       "      <td>2153-09-03</td>\n",
       "      <td>2153-09-08</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ELECTIVE</td>\n",
       "      <td>PHYS REFERRAL/NORMAL DELI</td>\n",
       "      <td>HOME HEALTH CARE</td>\n",
       "      <td>Medicare</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>M</td>\n",
       "      <td>2082-07-17</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>71</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>23</td>\n",
       "      <td>124321</td>\n",
       "      <td>2157-10-18</td>\n",
       "      <td>2157-10-25</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>TRANSFER FROM HOSP/EXTRAM</td>\n",
       "      <td>HOME HEALTH CARE</td>\n",
       "      <td>Medicare</td>\n",
       "      <td>ENGL</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>M</td>\n",
       "      <td>2082-07-17</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>75</td>\n",
       "      <td>2</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>24</td>\n",
       "      <td>161859</td>\n",
       "      <td>2139-06-06</td>\n",
       "      <td>2139-06-09</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>TRANSFER FROM HOSP/EXTRAM</td>\n",
       "      <td>HOME</td>\n",
       "      <td>Private</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>M</td>\n",
       "      <td>2100-05-31</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>39</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>25</td>\n",
       "      <td>129635</td>\n",
       "      <td>2160-11-02</td>\n",
       "      <td>2160-11-05</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>EMERGENCY ROOM ADMIT</td>\n",
       "      <td>HOME</td>\n",
       "      <td>Private</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>M</td>\n",
       "      <td>2101-11-21</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>58</td>\n",
       "      <td>1</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 27 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   SUBJECT_ID  HADM_ID   ADMITTIME   DISCHTIME DEATHTIME ADMISSION_TYPE  \\\n",
       "0          22   165315  2196-04-09  2196-04-10       NaN      EMERGENCY   \n",
       "1          23   152223  2153-09-03  2153-09-08       NaN       ELECTIVE   \n",
       "2          23   124321  2157-10-18  2157-10-25       NaN      EMERGENCY   \n",
       "3          24   161859  2139-06-06  2139-06-09       NaN      EMERGENCY   \n",
       "4          25   129635  2160-11-02  2160-11-05       NaN      EMERGENCY   \n",
       "\n",
       "          ADMISSION_LOCATION         DISCHARGE_LOCATION INSURANCE LANGUAGE  \\\n",
       "0       EMERGENCY ROOM ADMIT  DISC-TRAN CANCER/CHLDRN H   Private      NaN   \n",
       "1  PHYS REFERRAL/NORMAL DELI           HOME HEALTH CARE  Medicare      NaN   \n",
       "2  TRANSFER FROM HOSP/EXTRAM           HOME HEALTH CARE  Medicare     ENGL   \n",
       "3  TRANSFER FROM HOSP/EXTRAM                       HOME   Private      NaN   \n",
       "4       EMERGENCY ROOM ADMIT                       HOME   Private      NaN   \n",
       "\n",
       "   ... HAS_CHARTEVENTS_DATA GENDER         DOB  DOD DOD_HOSP DOD_SSN  \\\n",
       "0  ...                    1      F  2131-05-07  NaN      NaN     NaN   \n",
       "1  ...                    1      M  2082-07-17  NaN      NaN     NaN   \n",
       "2  ...                    1      M  2082-07-17  NaN      NaN     NaN   \n",
       "3  ...                    1      M  2100-05-31  NaN      NaN     NaN   \n",
       "4  ...                    1      M  2101-11-21  NaN      NaN     NaN   \n",
       "\n",
       "   EXPIRE_FLAG  AGE ADMIT_TIMES LENGTH_STAY  \n",
       "0            0   64           1           1  \n",
       "1            0   71           2           5  \n",
       "2            0   75           2           7  \n",
       "3            0   39           1           3  \n",
       "4            0   58           1           3  \n",
       "\n",
       "[5 rows x 27 columns]"
      ]
     },
     "execution_count": 65,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "adm_age.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "id": "c9a0fbee-ac53-4b67-a32e-776205e940cb",
   "metadata": {},
   "outputs": [],
   "source": [
    "adm_age_gb = adm_age.sort_values(by=['SUBJECT_ID', 'ADMITTIME']).groupby(['SUBJECT_ID'], axis=0, as_index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "id": "fa614bf4-61f7-416f-91b3-7cb9d4aaf821",
   "metadata": {},
   "outputs": [],
   "source": [
    "readmit = adm_age_gb.filter(lambda x: (x['SUBJECT_ID'].value_counts()) > 1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "id": "68d30921-c08b-4159-bc32-c08088d06d58",
   "metadata": {},
   "outputs": [],
   "source": [
    "readmit = readmit.reset_index(drop = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 69,
   "id": "2d755811-25b4-4f86-a420-13374d5ad7a3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>SUBJECT_ID</th>\n",
       "      <th>HADM_ID</th>\n",
       "      <th>ADMITTIME</th>\n",
       "      <th>DISCHTIME</th>\n",
       "      <th>DEATHTIME</th>\n",
       "      <th>ADMISSION_TYPE</th>\n",
       "      <th>ADMISSION_LOCATION</th>\n",
       "      <th>DISCHARGE_LOCATION</th>\n",
       "      <th>INSURANCE</th>\n",
       "      <th>LANGUAGE</th>\n",
       "      <th>...</th>\n",
       "      <th>HAS_CHARTEVENTS_DATA</th>\n",
       "      <th>GENDER</th>\n",
       "      <th>DOB</th>\n",
       "      <th>DOD</th>\n",
       "      <th>DOD_HOSP</th>\n",
       "      <th>DOD_SSN</th>\n",
       "      <th>EXPIRE_FLAG</th>\n",
       "      <th>AGE</th>\n",
       "      <th>ADMIT_TIMES</th>\n",
       "      <th>LENGTH_STAY</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>17</td>\n",
       "      <td>194023</td>\n",
       "      <td>2134-12-27</td>\n",
       "      <td>2134-12-31</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ELECTIVE</td>\n",
       "      <td>PHYS REFERRAL/NORMAL DELI</td>\n",
       "      <td>HOME HEALTH CARE</td>\n",
       "      <td>Private</td>\n",
       "      <td>ENGL</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>F</td>\n",
       "      <td>2087-07-14</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>47</td>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>17</td>\n",
       "      <td>161087</td>\n",
       "      <td>2135-05-09</td>\n",
       "      <td>2135-05-13</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>EMERGENCY ROOM ADMIT</td>\n",
       "      <td>HOME HEALTH CARE</td>\n",
       "      <td>Private</td>\n",
       "      <td>ENGL</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>F</td>\n",
       "      <td>2087-07-14</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>47</td>\n",
       "      <td>2</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>21</td>\n",
       "      <td>109451</td>\n",
       "      <td>2134-09-11</td>\n",
       "      <td>2134-09-24</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>EMERGENCY ROOM ADMIT</td>\n",
       "      <td>REHAB/DISTINCT PART HOSP</td>\n",
       "      <td>Medicare</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>M</td>\n",
       "      <td>2047-04-04</td>\n",
       "      <td>2135-02-08 00:00:00</td>\n",
       "      <td>2135-02-08 00:00:00</td>\n",
       "      <td>2135-02-08 00:00:00</td>\n",
       "      <td>1</td>\n",
       "      <td>87</td>\n",
       "      <td>2</td>\n",
       "      <td>13</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>21</td>\n",
       "      <td>111970</td>\n",
       "      <td>2135-01-30</td>\n",
       "      <td>2135-02-08</td>\n",
       "      <td>2135-02-08 02:08:00</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>EMERGENCY ROOM ADMIT</td>\n",
       "      <td>DEAD/EXPIRED</td>\n",
       "      <td>Medicare</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>M</td>\n",
       "      <td>2047-04-04</td>\n",
       "      <td>2135-02-08 00:00:00</td>\n",
       "      <td>2135-02-08 00:00:00</td>\n",
       "      <td>2135-02-08 00:00:00</td>\n",
       "      <td>1</td>\n",
       "      <td>87</td>\n",
       "      <td>2</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>23</td>\n",
       "      <td>152223</td>\n",
       "      <td>2153-09-03</td>\n",
       "      <td>2153-09-08</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ELECTIVE</td>\n",
       "      <td>PHYS REFERRAL/NORMAL DELI</td>\n",
       "      <td>HOME HEALTH CARE</td>\n",
       "      <td>Medicare</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>1</td>\n",
       "      <td>M</td>\n",
       "      <td>2082-07-17</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>71</td>\n",
       "      <td>2</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 27 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   SUBJECT_ID  HADM_ID   ADMITTIME   DISCHTIME            DEATHTIME  \\\n",
       "0          17   194023  2134-12-27  2134-12-31                  NaN   \n",
       "1          17   161087  2135-05-09  2135-05-13                  NaN   \n",
       "2          21   109451  2134-09-11  2134-09-24                  NaN   \n",
       "3          21   111970  2135-01-30  2135-02-08  2135-02-08 02:08:00   \n",
       "4          23   152223  2153-09-03  2153-09-08                  NaN   \n",
       "\n",
       "  ADMISSION_TYPE         ADMISSION_LOCATION        DISCHARGE_LOCATION  \\\n",
       "0       ELECTIVE  PHYS REFERRAL/NORMAL DELI          HOME HEALTH CARE   \n",
       "1      EMERGENCY       EMERGENCY ROOM ADMIT          HOME HEALTH CARE   \n",
       "2      EMERGENCY       EMERGENCY ROOM ADMIT  REHAB/DISTINCT PART HOSP   \n",
       "3      EMERGENCY       EMERGENCY ROOM ADMIT              DEAD/EXPIRED   \n",
       "4       ELECTIVE  PHYS REFERRAL/NORMAL DELI          HOME HEALTH CARE   \n",
       "\n",
       "  INSURANCE LANGUAGE  ... HAS_CHARTEVENTS_DATA GENDER         DOB  \\\n",
       "0   Private     ENGL  ...                    1      F  2087-07-14   \n",
       "1   Private     ENGL  ...                    1      F  2087-07-14   \n",
       "2  Medicare      NaN  ...                    1      M  2047-04-04   \n",
       "3  Medicare      NaN  ...                    1      M  2047-04-04   \n",
       "4  Medicare      NaN  ...                    1      M  2082-07-17   \n",
       "\n",
       "                   DOD             DOD_HOSP              DOD_SSN  EXPIRE_FLAG  \\\n",
       "0                  NaN                  NaN                  NaN            0   \n",
       "1                  NaN                  NaN                  NaN            0   \n",
       "2  2135-02-08 00:00:00  2135-02-08 00:00:00  2135-02-08 00:00:00            1   \n",
       "3  2135-02-08 00:00:00  2135-02-08 00:00:00  2135-02-08 00:00:00            1   \n",
       "4                  NaN                  NaN                  NaN            0   \n",
       "\n",
       "   AGE ADMIT_TIMES LENGTH_STAY  \n",
       "0   47           2           4  \n",
       "1   47           2           4  \n",
       "2   87           2          13  \n",
       "3   87           2           9  \n",
       "4   71           2           5  \n",
       "\n",
       "[5 rows x 27 columns]"
      ]
     },
     "execution_count": 69,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "readmit.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 70,
   "id": "dc2c574e-fb38-4411-b7ee-550e535bcdd0",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Count Readmit Days For Each Subject\n",
    "\n",
    "def count_days(df):\n",
    "    ID = df.loc[0, 'SUBJECT_ID']\n",
    "    count = 0\n",
    "    day = df.loc[0, 'ADMITTIME']\n",
    "    \n",
    "    for i in range(len(df)):\n",
    "        if df.loc[i, 'SUBJECT_ID'] == ID:\n",
    "            count += 1\n",
    "        else:\n",
    "            ID = df.loc[i, 'SUBJECT_ID']\n",
    "            count = 1\n",
    "            \n",
    "        if count > 1:\n",
    "            df.loc[i, 'READMIT_DAY'] = (df.loc[i,'ADMITTIME'] - day).days\n",
    "            day = df.loc[i, 'DISCHTIME']\n",
    "        else:\n",
    "            df.loc[i, 'READMIT_DAY'] = 0\n",
    "            day = df.loc[i, 'DISCHTIME']\n",
    "            \n",
    "            \n",
    "    return df"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 71,
   "id": "d70ce26a-5745-476f-9c91-c9448807dc09",
   "metadata": {},
   "outputs": [],
   "source": [
    "readmit = count_days(readmit)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "id": "9b68f656-6173-43e6-9dd5-8e1affd3116b",
   "metadata": {},
   "outputs": [],
   "source": [
    "readmit['READMIT_DAY'] = readmit['READMIT_DAY'].astype(int)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "id": "b4a759f4-8a4a-480f-add4-67387b2020e1",
   "metadata": {},
   "outputs": [],
   "source": [
    "readmit = readmit[(readmit['READMIT_DAY'] >= 0) & (readmit['READMIT_DAY'] < 30)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 74,
   "id": "4fc1ef39-2ed6-4140-9f36-8341792c1e30",
   "metadata": {},
   "outputs": [],
   "source": [
    "readmit=readmit.reset_index(drop=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 75,
   "id": "0e189b26-aa76-489f-a0c0-e5e4dc4a3ef8",
   "metadata": {},
   "outputs": [],
   "source": [
    "# All Aptients who admit within 30 days include their first day\n",
    "readmit = readmit.groupby(['SUBJECT_ID'], axis=0, as_index=False).filter(lambda x: (x['SUBJECT_ID'].value_counts()) > 1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 76,
   "id": "5a5cd253-5f24-4312-bdfd-c156811c1802",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(6003, 28)"
      ]
     },
     "execution_count": 76,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "readmit.shape"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "836bd40b-be32-481a-9c6f-cb92dd942e90",
   "metadata": {
    "jp-MarkdownHeadingCollapsed": true,
    "tags": []
   },
   "source": [
    "#### Test Function"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 77,
   "id": "dc6034c4-ad6b-4112-b6c0-0535d44c6c1a",
   "metadata": {},
   "outputs": [],
   "source": [
    "# test\n",
    "data = {'SUBJECT_ID': [23, 23,\n",
    "                 24, 24, 25, 25, 25],\n",
    "        'ADMITTIME': ['2153-09-03 07:15:00', '2157-10-18 19:34:00', '2186-07-18 16:46:00', '2191-02-23 05:23:00', '2186-01-16 10:30:00', '2186-02-08 12:30:00', '2189-07-10 18:08:00'],\n",
    "        'DISCHTIME': ['2153-09-08 19:10:00', '2157-10-25 14:00:00', '2186-07-20 16:00:00', '2191-02-25 20:20:00', '2186-01-16 16:30:00', '2186-02-08 20:21:00', '2189-07-17 14:57:00']}\n",
    "\n",
    "df_test = pd.DataFrame(data, columns=['SUBJECT_ID', 'ADMITTIME',\n",
    "                                 'DISCHTIME'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 78,
   "id": "75a3e73f-f263-4b04-af2b-de543a549367",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_test['ADMITTIME'] = pd.to_datetime(df_test['ADMITTIME']).dt.date\n",
    "df_test['DISCHTIME'] = pd.to_datetime(df_test['DISCHTIME']).dt.date\n",
    "\n",
    "df_new = count_days(df_test)\n",
    "df_new['READMIT_DAY'] = df_new['READMIT_DAY'].astype(int)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 79,
   "id": "0bd26e85-5926-4754-81ae-7d49ab756149",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>SUBJECT_ID</th>\n",
       "      <th>ADMITTIME</th>\n",
       "      <th>DISCHTIME</th>\n",
       "      <th>READMIT_DAY</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>23</td>\n",
       "      <td>2153-09-03</td>\n",
       "      <td>2153-09-08</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>23</td>\n",
       "      <td>2157-10-18</td>\n",
       "      <td>2157-10-25</td>\n",
       "      <td>1501</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>24</td>\n",
       "      <td>2186-07-18</td>\n",
       "      <td>2186-07-20</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>24</td>\n",
       "      <td>2191-02-23</td>\n",
       "      <td>2191-02-25</td>\n",
       "      <td>1679</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>25</td>\n",
       "      <td>2186-01-16</td>\n",
       "      <td>2186-01-16</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>25</td>\n",
       "      <td>2186-02-08</td>\n",
       "      <td>2186-02-08</td>\n",
       "      <td>23</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>25</td>\n",
       "      <td>2189-07-10</td>\n",
       "      <td>2189-07-17</td>\n",
       "      <td>1248</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   SUBJECT_ID   ADMITTIME   DISCHTIME  READMIT_DAY\n",
       "0          23  2153-09-03  2153-09-08            0\n",
       "1          23  2157-10-18  2157-10-25         1501\n",
       "2          24  2186-07-18  2186-07-20            0\n",
       "3          24  2191-02-23  2191-02-25         1679\n",
       "4          25  2186-01-16  2186-01-16            0\n",
       "5          25  2186-02-08  2186-02-08           23\n",
       "6          25  2189-07-10  2189-07-17         1248"
      ]
     },
     "execution_count": 79,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df_new"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "afc873e1-d10e-4d64-b5ee-36aa3ba3c577",
   "metadata": {
    "tags": []
   },
   "source": [
    "# GROUP I: Patient With VTE Readmit Within 30 days"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 147,
   "id": "6743ebc6-db57-45f1-8ba8-071aa10887f7",
   "metadata": {},
   "outputs": [],
   "source": [
    "readmit_subset = readmit[['SUBJECT_ID', 'HADM_ID', 'READMIT_DAY']]\n",
    "vte_readmit = pd.merge(vte_adm, readmit_subset, how='inner', on=['SUBJECT_ID', 'HADM_ID'])\n",
    "vte_readmit = vte_readmit.drop('ROW_ID', axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 148,
   "id": "ec6a19aa-4f16-4088-9622-67dc03a674f4",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>SUBJECT_ID</th>\n",
       "      <th>HADM_ID</th>\n",
       "      <th>SEQ_NUM</th>\n",
       "      <th>ICD9_CODE</th>\n",
       "      <th>ADMITTIME</th>\n",
       "      <th>DISCHTIME</th>\n",
       "      <th>DEATHTIME</th>\n",
       "      <th>ADMISSION_TYPE</th>\n",
       "      <th>ADMISSION_LOCATION</th>\n",
       "      <th>DISCHARGE_LOCATION</th>\n",
       "      <th>...</th>\n",
       "      <th>DOB</th>\n",
       "      <th>DOD</th>\n",
       "      <th>DOD_HOSP</th>\n",
       "      <th>DOD_SSN</th>\n",
       "      <th>EXPIRE_FLAG</th>\n",
       "      <th>AGE</th>\n",
       "      <th>ADMIT_TIMES</th>\n",
       "      <th>LENGTH_STAY</th>\n",
       "      <th>AGE_RANGE</th>\n",
       "      <th>READMIT_DAY</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>32810</td>\n",
       "      <td>168208</td>\n",
       "      <td>5.0</td>\n",
       "      <td>4538</td>\n",
       "      <td>2100-10-29</td>\n",
       "      <td>2100-11-05</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>EMERGENCY ROOM ADMIT</td>\n",
       "      <td>REHAB/DISTINCT PART HOSP</td>\n",
       "      <td>...</td>\n",
       "      <td>2078-04-20</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>22</td>\n",
       "      <td>2</td>\n",
       "      <td>7</td>\n",
       "      <td>[20-29]</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>32810</td>\n",
       "      <td>189751</td>\n",
       "      <td>11.0</td>\n",
       "      <td>4538</td>\n",
       "      <td>2100-09-18</td>\n",
       "      <td>2100-10-26</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>EMERGENCY ROOM ADMIT</td>\n",
       "      <td>REHAB/DISTINCT PART HOSP</td>\n",
       "      <td>...</td>\n",
       "      <td>2078-04-20</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>22</td>\n",
       "      <td>2</td>\n",
       "      <td>38</td>\n",
       "      <td>[20-29]</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>109</td>\n",
       "      <td>124657</td>\n",
       "      <td>7.0</td>\n",
       "      <td>45184</td>\n",
       "      <td>2142-01-14</td>\n",
       "      <td>2142-01-20</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>EMERGENCY ROOM ADMIT</td>\n",
       "      <td>HOME</td>\n",
       "      <td>...</td>\n",
       "      <td>2117-08-07</td>\n",
       "      <td>2142-08-30 00:00:00</td>\n",
       "      <td>2142-08-30 00:00:00</td>\n",
       "      <td>2142-08-30 00:00:00</td>\n",
       "      <td>1</td>\n",
       "      <td>24</td>\n",
       "      <td>34</td>\n",
       "      <td>6</td>\n",
       "      <td>[20-29]</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>109</td>\n",
       "      <td>176760</td>\n",
       "      <td>6.0</td>\n",
       "      <td>45184</td>\n",
       "      <td>2142-01-21</td>\n",
       "      <td>2142-01-23</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>EMERGENCY ROOM ADMIT</td>\n",
       "      <td>HOME</td>\n",
       "      <td>...</td>\n",
       "      <td>2117-08-07</td>\n",
       "      <td>2142-08-30 00:00:00</td>\n",
       "      <td>2142-08-30 00:00:00</td>\n",
       "      <td>2142-08-30 00:00:00</td>\n",
       "      <td>1</td>\n",
       "      <td>24</td>\n",
       "      <td>34</td>\n",
       "      <td>2</td>\n",
       "      <td>[20-29]</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>91469</td>\n",
       "      <td>192145</td>\n",
       "      <td>3.0</td>\n",
       "      <td>4532</td>\n",
       "      <td>2104-02-18</td>\n",
       "      <td>2104-02-27</td>\n",
       "      <td>NaN</td>\n",
       "      <td>ELECTIVE</td>\n",
       "      <td>PHYS REFERRAL/NORMAL DELI</td>\n",
       "      <td>HOME</td>\n",
       "      <td>...</td>\n",
       "      <td>2078-05-06</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>25</td>\n",
       "      <td>2</td>\n",
       "      <td>9</td>\n",
       "      <td>[20-29]</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 31 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   SUBJECT_ID  HADM_ID  SEQ_NUM ICD9_CODE   ADMITTIME   DISCHTIME DEATHTIME  \\\n",
       "0       32810   168208      5.0      4538  2100-10-29  2100-11-05       NaN   \n",
       "1       32810   189751     11.0      4538  2100-09-18  2100-10-26       NaN   \n",
       "2         109   124657      7.0     45184  2142-01-14  2142-01-20       NaN   \n",
       "3         109   176760      6.0     45184  2142-01-21  2142-01-23       NaN   \n",
       "4       91469   192145      3.0      4532  2104-02-18  2104-02-27       NaN   \n",
       "\n",
       "  ADMISSION_TYPE         ADMISSION_LOCATION        DISCHARGE_LOCATION  ...  \\\n",
       "0      EMERGENCY       EMERGENCY ROOM ADMIT  REHAB/DISTINCT PART HOSP  ...   \n",
       "1      EMERGENCY       EMERGENCY ROOM ADMIT  REHAB/DISTINCT PART HOSP  ...   \n",
       "2      EMERGENCY       EMERGENCY ROOM ADMIT                      HOME  ...   \n",
       "3      EMERGENCY       EMERGENCY ROOM ADMIT                      HOME  ...   \n",
       "4       ELECTIVE  PHYS REFERRAL/NORMAL DELI                      HOME  ...   \n",
       "\n",
       "          DOB                  DOD             DOD_HOSP              DOD_SSN  \\\n",
       "0  2078-04-20                  NaN                  NaN                  NaN   \n",
       "1  2078-04-20                  NaN                  NaN                  NaN   \n",
       "2  2117-08-07  2142-08-30 00:00:00  2142-08-30 00:00:00  2142-08-30 00:00:00   \n",
       "3  2117-08-07  2142-08-30 00:00:00  2142-08-30 00:00:00  2142-08-30 00:00:00   \n",
       "4  2078-05-06                  NaN                  NaN                  NaN   \n",
       "\n",
       "  EXPIRE_FLAG AGE ADMIT_TIMES LENGTH_STAY  AGE_RANGE  READMIT_DAY  \n",
       "0           0  22           2           7    [20-29]            3  \n",
       "1           0  22           2          38    [20-29]            0  \n",
       "2           1  24          34           6    [20-29]            1  \n",
       "3           1  24          34           2    [20-29]            1  \n",
       "4           0  25           2           9    [20-29]           10  \n",
       "\n",
       "[5 rows x 31 columns]"
      ]
     },
     "execution_count": 148,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vte_readmit.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 149,
   "id": "720d43c2-49e8-4182-a0b0-b8727932997e",
   "metadata": {},
   "outputs": [],
   "source": [
    "vte_id = vte_readmit[['SUBJECT_ID','HADM_ID']]\n",
    "vte_id = vte_id[['SUBJECT_ID','HADM_ID']].apply(tuple, axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 150,
   "id": "bb8141c5-d568-4daa-a777-a58d430dabd0",
   "metadata": {},
   "outputs": [],
   "source": [
    "# unique vte SID & HID\n",
    "vte_uid = vte_readmit.drop_duplicates(subset = ['SUBJECT_ID', 'HADM_ID','ETHNICITY', 'GENDER', 'AGE', 'ADMIT_TIMES', 'LENGTH_STAY', 'READMIT_DAY'],keep = 'last').reset_index(drop = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 151,
   "id": "a7da3dac-13e6-4193-a3dd-b03709f879c0",
   "metadata": {},
   "outputs": [],
   "source": [
    "# VTE readmit patients' total number\n",
    "vte_uid = vte_uid.drop(['ICD9_CODE'], axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 202,
   "id": "cdf9a0fc-0b19-453b-8ffe-8fb5573db85e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(197, 30)"
      ]
     },
     "execution_count": 202,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vte_uid.shape"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "db97a4c4-5b5d-42ec-8d0e-429a9669c419",
   "metadata": {
    "jp-MarkdownHeadingCollapsed": true,
    "tags": []
   },
   "source": [
    "#### Gender"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 154,
   "id": "cb0f73fd-0487-45bf-8f18-3369f7114692",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "M    113\n",
       "F     84\n",
       "Name: GENDER, dtype: int64"
      ]
     },
     "execution_count": 154,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vte_uid.GENDER.value_counts()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "763e723c-04e6-48f3-8bd3-985791bbcd0f",
   "metadata": {
    "jp-MarkdownHeadingCollapsed": true,
    "tags": []
   },
   "source": [
    "#### Race"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 155,
   "id": "be295d32-7dd0-4f4e-85ce-f657e01b0d29",
   "metadata": {},
   "outputs": [],
   "source": [
    "# total\n",
    "race2 = vte_uid.groupby('ETHNICITY').size()\n",
    "race2_prop = race2.div(len(vte_uid))*100"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 156,
   "id": "aa078cf7-13ac-4edd-8d69-fa28fc221668",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ETHNICITY\n",
       "WHITE                    76.142132\n",
       "BLACK                    13.197970\n",
       "HISPANIC OR LATINO        5.076142\n",
       "OTHER                     2.030457\n",
       "ASIAN                     1.522843\n",
       "UNKNOWN/NOT SPECIFIED     1.522843\n",
       "UNABLE TO OBTAIN          0.507614\n",
       "dtype: float64"
      ]
     },
     "execution_count": 156,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "race2_prop.sort_values(ascending=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 157,
   "id": "bf5b75b8-651a-416e-8ca8-861448cff735",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ETHNICITY\n",
       "WHITE                    150\n",
       "BLACK                     26\n",
       "HISPANIC OR LATINO        10\n",
       "OTHER                      4\n",
       "ASIAN                      3\n",
       "UNKNOWN/NOT SPECIFIED      3\n",
       "UNABLE TO OBTAIN           1\n",
       "dtype: int64"
      ]
     },
     "execution_count": 157,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "race2.sort_values(ascending=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 158,
   "id": "6bdc9b56-6d45-4247-b303-85f519552f53",
   "metadata": {},
   "outputs": [],
   "source": [
    "# female\n",
    "race2_f = vte_uid[vte_uid['GENDER'] == 'F'].groupby('ETHNICITY').size()\n",
    "race2_f_prop = race2_f.div(len(vte_uid[vte_uid['GENDER'] == 'F']))*100"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 159,
   "id": "aab20a14-cb3f-4fcf-8a36-18e5772c55fe",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ETHNICITY\n",
       "WHITE                 67.857143\n",
       "BLACK                 17.857143\n",
       "HISPANIC OR LATINO     7.142857\n",
       "OTHER                  4.761905\n",
       "ASIAN                  2.380952\n",
       "dtype: float64"
      ]
     },
     "execution_count": 159,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "race2_f_prop.sort_values(ascending=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 160,
   "id": "4eb6e9ff-13d3-43eb-930e-67dcba9b109c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ETHNICITY\n",
       "WHITE                 57\n",
       "BLACK                 15\n",
       "HISPANIC OR LATINO     6\n",
       "OTHER                  4\n",
       "ASIAN                  2\n",
       "dtype: int64"
      ]
     },
     "execution_count": 160,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "race2_f.sort_values(ascending=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 161,
   "id": "1123163f-fd4b-4267-ade7-6924fbceb6a4",
   "metadata": {},
   "outputs": [],
   "source": [
    "# male\n",
    "race2_m = vte_uid[vte_uid['GENDER'] == 'M'].groupby('ETHNICITY').size()\n",
    "race2_m_prop = race2_m.div(len(vte_uid[vte_uid['GENDER'] == 'M']))*100"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 162,
   "id": "620bfd7f-9aa3-402d-893e-1c6ea8d8fb57",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ETHNICITY\n",
       "WHITE                    82.300885\n",
       "BLACK                     9.734513\n",
       "HISPANIC OR LATINO        3.539823\n",
       "UNKNOWN/NOT SPECIFIED     2.654867\n",
       "ASIAN                     0.884956\n",
       "UNABLE TO OBTAIN          0.884956\n",
       "dtype: float64"
      ]
     },
     "execution_count": 162,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "race2_m_prop.sort_values(ascending=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 163,
   "id": "36a5fa64-cc32-4158-a924-bf9f6853f88a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ETHNICITY\n",
       "WHITE                    93\n",
       "BLACK                    11\n",
       "HISPANIC OR LATINO        4\n",
       "UNKNOWN/NOT SPECIFIED     3\n",
       "ASIAN                     1\n",
       "UNABLE TO OBTAIN          1\n",
       "dtype: int64"
      ]
     },
     "execution_count": 163,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "race2_m.sort_values(ascending=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "49b66539-a3d3-43ec-bd22-f422f37f0625",
   "metadata": {
    "jp-MarkdownHeadingCollapsed": true,
    "tags": []
   },
   "source": [
    "#### Age"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 164,
   "id": "1cf903f1-f64d-4a5d-ad17-9d65bfb23041",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    197.000000\n",
       "mean      68.045685\n",
       "std       36.689443\n",
       "min       22.000000\n",
       "25%       54.000000\n",
       "50%       66.000000\n",
       "75%       76.000000\n",
       "max      300.000000\n",
       "Name: AGE, dtype: float64"
      ]
     },
     "execution_count": 164,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vte_uid['AGE'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 165,
   "id": "abcf1303-f139-47a5-a58f-06e879466698",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count     84.000000\n",
       "mean      69.107143\n",
       "std       39.575463\n",
       "min       24.000000\n",
       "25%       54.000000\n",
       "50%       66.000000\n",
       "75%       76.000000\n",
       "max      300.000000\n",
       "Name: AGE, dtype: float64"
      ]
     },
     "execution_count": 165,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# female\n",
    "vte_uid['AGE'][vte_uid['GENDER'] == 'F'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 166,
   "id": "77a82f11-0752-461e-a927-fcdab718cac3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    113.000000\n",
       "mean      67.256637\n",
       "std       34.547787\n",
       "min       22.000000\n",
       "25%       55.000000\n",
       "50%       65.000000\n",
       "75%       76.000000\n",
       "max      300.000000\n",
       "Name: AGE, dtype: float64"
      ]
     },
     "execution_count": 166,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# male\n",
    "vte_uid['AGE'][vte_uid['GENDER'] == 'M'].describe()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a4def701-0421-4ccd-b4f9-f860a877944c",
   "metadata": {
    "jp-MarkdownHeadingCollapsed": true,
    "tags": []
   },
   "source": [
    "#### Length Stay"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 167,
   "id": "0bbab9d8-77f9-43b1-9e40-6e75c7a4b419",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    197.000000\n",
       "mean      17.725888\n",
       "std       18.009521\n",
       "min        2.000000\n",
       "25%        8.000000\n",
       "50%       14.000000\n",
       "75%       21.000000\n",
       "max      169.000000\n",
       "Name: LENGTH_STAY, dtype: float64"
      ]
     },
     "execution_count": 167,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vte_uid['LENGTH_STAY'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 168,
   "id": "b5d65912-d832-4ebb-8dfd-11c3829a8fa9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count     84.000000\n",
       "mean      18.190476\n",
       "std       16.826167\n",
       "min        2.000000\n",
       "25%        7.750000\n",
       "50%       14.000000\n",
       "75%       21.000000\n",
       "max      100.000000\n",
       "Name: LENGTH_STAY, dtype: float64"
      ]
     },
     "execution_count": 168,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# female\n",
    "vte_uid['LENGTH_STAY'][vte_uid['GENDER'] == 'F'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 169,
   "id": "bdab2441-5f07-405a-940c-6d3912b1ddc1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    113.000000\n",
       "mean      17.380531\n",
       "std       18.907821\n",
       "min        2.000000\n",
       "25%        8.000000\n",
       "50%       14.000000\n",
       "75%       20.000000\n",
       "max      169.000000\n",
       "Name: LENGTH_STAY, dtype: float64"
      ]
     },
     "execution_count": 169,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# male\n",
    "vte_uid['LENGTH_STAY'][vte_uid['GENDER'] == 'M'].describe()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "3ac3d561-2289-4141-bb66-10c2c8757d30",
   "metadata": {
    "jp-MarkdownHeadingCollapsed": true,
    "tags": []
   },
   "source": [
    "#### Admit Times"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 170,
   "id": "946ae322-fe0d-4eaf-b6f3-7122d833b295",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    206.000000\n",
       "mean       3.975728\n",
       "std        3.929177\n",
       "min        2.000000\n",
       "25%        2.000000\n",
       "50%        3.000000\n",
       "75%        4.000000\n",
       "max       34.000000\n",
       "Name: ADMIT_TIMES, dtype: float64"
      ]
     },
     "execution_count": 170,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vte_readmit['ADMIT_TIMES'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 171,
   "id": "f79d10eb-0c21-49a0-b9be-0ddf1bcada6e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    89.000000\n",
       "mean      4.449438\n",
       "std       5.276473\n",
       "min       2.000000\n",
       "25%       2.000000\n",
       "50%       3.000000\n",
       "75%       4.000000\n",
       "max      34.000000\n",
       "Name: ADMIT_TIMES, dtype: float64"
      ]
     },
     "execution_count": 171,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# female\n",
    "vte_readmit['ADMIT_TIMES'][vte_readmit['GENDER'] == 'F'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 172,
   "id": "1e43d1e2-61b6-4cf9-a7e7-664402b3275a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    117.000000\n",
       "mean       3.615385\n",
       "std        2.420623\n",
       "min        2.000000\n",
       "25%        2.000000\n",
       "50%        3.000000\n",
       "75%        4.000000\n",
       "max       12.000000\n",
       "Name: ADMIT_TIMES, dtype: float64"
      ]
     },
     "execution_count": 172,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# male\n",
    "vte_readmit['ADMIT_TIMES'][vte_readmit['GENDER'] == 'M'].describe()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c350970f-181d-4cd8-b8cf-5cc487bf632c",
   "metadata": {
    "jp-MarkdownHeadingCollapsed": true,
    "tags": []
   },
   "source": [
    "#### Readmit Days"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 173,
   "id": "3a682286-2ec6-4279-8694-77ddd23aab64",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    130.000000\n",
       "mean      10.723077\n",
       "std        7.865158\n",
       "min        1.000000\n",
       "25%        5.000000\n",
       "50%        9.000000\n",
       "75%       15.000000\n",
       "max       29.000000\n",
       "Name: READMIT_DAY, dtype: float64"
      ]
     },
     "execution_count": 173,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vte_uid[vte_uid['READMIT_DAY'] > 0].READMIT_DAY.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 105,
   "id": "808123b3-2a61-4665-8fc1-2a9a593649a1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    51.000000\n",
       "mean     10.529412\n",
       "std       7.669036\n",
       "min       1.000000\n",
       "25%       5.000000\n",
       "50%       9.000000\n",
       "75%      15.500000\n",
       "max      29.000000\n",
       "Name: READMIT_DAY, dtype: float64"
      ]
     },
     "execution_count": 105,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# female\n",
    "vte_uid[(vte_uid['READMIT_DAY'] > 0) & (vte_uid['GENDER'] == 'F')].READMIT_DAY.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 106,
   "id": "4a520b2e-3bd1-4487-9db2-c76d901ef956",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    79.000000\n",
       "mean     10.848101\n",
       "std       8.035320\n",
       "min       1.000000\n",
       "25%       5.000000\n",
       "50%       9.000000\n",
       "75%      15.000000\n",
       "max      29.000000\n",
       "Name: READMIT_DAY, dtype: float64"
      ]
     },
     "execution_count": 106,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# male\n",
    "vte_uid[(vte_uid['READMIT_DAY'] > 0) & (vte_uid['GENDER'] == 'M')].READMIT_DAY.describe()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "cd1f45df-e0a9-445c-bd8a-ca4006885822",
   "metadata": {
    "tags": []
   },
   "source": [
    "# GROUP II: Patient Without VTE Readmit Within 30 Days"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 107,
   "id": "265cf44b-660b-42b2-9c65-758aaa64eeb6",
   "metadata": {},
   "outputs": [],
   "source": [
    "nvte_readmit = readmit[~readmit[['SUBJECT_ID', 'HADM_ID']].apply(tuple, axis=1).isin(vte_id)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 108,
   "id": "96faf4a4-0102-4d54-b953-d97e1be6d90b",
   "metadata": {},
   "outputs": [],
   "source": [
    "# nvte unique SID & HID\n",
    "nvte_uid = nvte_readmit.reset_index(drop = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 109,
   "id": "101e9574-8eab-4adf-a7e8-f44b4aca0100",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>SUBJECT_ID</th>\n",
       "      <th>HADM_ID</th>\n",
       "      <th>ADMITTIME</th>\n",
       "      <th>DISCHTIME</th>\n",
       "      <th>DEATHTIME</th>\n",
       "      <th>ADMISSION_TYPE</th>\n",
       "      <th>ADMISSION_LOCATION</th>\n",
       "      <th>DISCHARGE_LOCATION</th>\n",
       "      <th>INSURANCE</th>\n",
       "      <th>LANGUAGE</th>\n",
       "      <th>...</th>\n",
       "      <th>GENDER</th>\n",
       "      <th>DOB</th>\n",
       "      <th>DOD</th>\n",
       "      <th>DOD_HOSP</th>\n",
       "      <th>DOD_SSN</th>\n",
       "      <th>EXPIRE_FLAG</th>\n",
       "      <th>AGE</th>\n",
       "      <th>ADMIT_TIMES</th>\n",
       "      <th>LENGTH_STAY</th>\n",
       "      <th>READMIT_DAY</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>36</td>\n",
       "      <td>182104</td>\n",
       "      <td>2131-04-30</td>\n",
       "      <td>2131-05-08</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>CLINIC REFERRAL/PREMATURE</td>\n",
       "      <td>HOME HEALTH CARE</td>\n",
       "      <td>Medicare</td>\n",
       "      <td>ENGL</td>\n",
       "      <td>...</td>\n",
       "      <td>M</td>\n",
       "      <td>2061-08-17</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>69</td>\n",
       "      <td>3</td>\n",
       "      <td>8</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>68</td>\n",
       "      <td>170467</td>\n",
       "      <td>2173-12-15</td>\n",
       "      <td>2174-01-03</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>EMERGENCY ROOM ADMIT</td>\n",
       "      <td>HOME HEALTH CARE</td>\n",
       "      <td>Medicare</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>F</td>\n",
       "      <td>2132-02-29</td>\n",
       "      <td>2174-02-11 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2174-02-11 00:00:00</td>\n",
       "      <td>1</td>\n",
       "      <td>41</td>\n",
       "      <td>2</td>\n",
       "      <td>19</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>68</td>\n",
       "      <td>108329</td>\n",
       "      <td>2174-01-04</td>\n",
       "      <td>2174-01-19</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>EMERGENCY ROOM ADMIT</td>\n",
       "      <td>SNF</td>\n",
       "      <td>Medicare</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>F</td>\n",
       "      <td>2132-02-29</td>\n",
       "      <td>2174-02-11 00:00:00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2174-02-11 00:00:00</td>\n",
       "      <td>1</td>\n",
       "      <td>41</td>\n",
       "      <td>2</td>\n",
       "      <td>15</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>103</td>\n",
       "      <td>130744</td>\n",
       "      <td>2144-08-12</td>\n",
       "      <td>2144-08-20</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>TRANSFER FROM HOSP/EXTRAM</td>\n",
       "      <td>SNF</td>\n",
       "      <td>Private</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>F</td>\n",
       "      <td>2084-04-14</td>\n",
       "      <td>2144-09-01 00:00:00</td>\n",
       "      <td>2144-09-01 00:00:00</td>\n",
       "      <td>2144-09-01 00:00:00</td>\n",
       "      <td>1</td>\n",
       "      <td>60</td>\n",
       "      <td>2</td>\n",
       "      <td>8</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>103</td>\n",
       "      <td>133550</td>\n",
       "      <td>2144-08-30</td>\n",
       "      <td>2144-09-01</td>\n",
       "      <td>2144-09-01 14:28:00</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>EMERGENCY ROOM ADMIT</td>\n",
       "      <td>DEAD/EXPIRED</td>\n",
       "      <td>Private</td>\n",
       "      <td>NaN</td>\n",
       "      <td>...</td>\n",
       "      <td>F</td>\n",
       "      <td>2084-04-14</td>\n",
       "      <td>2144-09-01 00:00:00</td>\n",
       "      <td>2144-09-01 00:00:00</td>\n",
       "      <td>2144-09-01 00:00:00</td>\n",
       "      <td>1</td>\n",
       "      <td>60</td>\n",
       "      <td>2</td>\n",
       "      <td>2</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 28 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   SUBJECT_ID  HADM_ID   ADMITTIME   DISCHTIME            DEATHTIME  \\\n",
       "0          36   182104  2131-04-30  2131-05-08                  NaN   \n",
       "1          68   170467  2173-12-15  2174-01-03                  NaN   \n",
       "2          68   108329  2174-01-04  2174-01-19                  NaN   \n",
       "3         103   130744  2144-08-12  2144-08-20                  NaN   \n",
       "4         103   133550  2144-08-30  2144-09-01  2144-09-01 14:28:00   \n",
       "\n",
       "  ADMISSION_TYPE         ADMISSION_LOCATION DISCHARGE_LOCATION INSURANCE  \\\n",
       "0      EMERGENCY  CLINIC REFERRAL/PREMATURE   HOME HEALTH CARE  Medicare   \n",
       "1      EMERGENCY       EMERGENCY ROOM ADMIT   HOME HEALTH CARE  Medicare   \n",
       "2      EMERGENCY       EMERGENCY ROOM ADMIT                SNF  Medicare   \n",
       "3      EMERGENCY  TRANSFER FROM HOSP/EXTRAM                SNF   Private   \n",
       "4      EMERGENCY       EMERGENCY ROOM ADMIT       DEAD/EXPIRED   Private   \n",
       "\n",
       "  LANGUAGE  ... GENDER         DOB                  DOD             DOD_HOSP  \\\n",
       "0     ENGL  ...      M  2061-08-17                  NaN                  NaN   \n",
       "1      NaN  ...      F  2132-02-29  2174-02-11 00:00:00                  NaN   \n",
       "2      NaN  ...      F  2132-02-29  2174-02-11 00:00:00                  NaN   \n",
       "3      NaN  ...      F  2084-04-14  2144-09-01 00:00:00  2144-09-01 00:00:00   \n",
       "4      NaN  ...      F  2084-04-14  2144-09-01 00:00:00  2144-09-01 00:00:00   \n",
       "\n",
       "               DOD_SSN EXPIRE_FLAG  AGE  ADMIT_TIMES LENGTH_STAY READMIT_DAY  \n",
       "0                  NaN           0   69            3           8           0  \n",
       "1  2174-02-11 00:00:00           1   41            2          19           0  \n",
       "2  2174-02-11 00:00:00           1   41            2          15           1  \n",
       "3  2144-09-01 00:00:00           1   60            2           8           0  \n",
       "4  2144-09-01 00:00:00           1   60            2           2          10  \n",
       "\n",
       "[5 rows x 28 columns]"
      ]
     },
     "execution_count": 109,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# nvte nvte patients' total number\n",
    "nvte_uid.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "dcecf8c8-4a19-40d7-879e-ad70bcb34c58",
   "metadata": {
    "tags": []
   },
   "source": [
    "#### Gender"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 110,
   "id": "94c0d99a-138b-41bd-a256-fd46ba3d3890",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "M    3335\n",
       "F    2471\n",
       "Name: GENDER, dtype: int64"
      ]
     },
     "execution_count": 110,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nvte_uid.GENDER.value_counts()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "8b39a738-3d09-4104-b0c3-d1e184cd0c73",
   "metadata": {
    "jp-MarkdownHeadingCollapsed": true,
    "tags": []
   },
   "source": [
    "#### Race"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 111,
   "id": "5a56e08c-2824-4afe-9fe8-21b4cfc993a2",
   "metadata": {},
   "outputs": [],
   "source": [
    "# total\n",
    "race3 = nvte_uid.groupby('ETHNICITY').size()\n",
    "race3_prop = race3.div(len(nvte_uid))*100"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 112,
   "id": "820d8fa5-c752-446c-b6fd-864bb5f375c9",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ETHNICITY\n",
       "WHITE                                        71.133310\n",
       "BLACK                                        13.606614\n",
       "UNKNOWN/NOT SPECIFIED                         4.099208\n",
       "ASIAN                                         3.530830\n",
       "HISPANIC OR LATINO                            3.496383\n",
       "OTHER                                         2.325181\n",
       "PATIENT DECLINED TO ANSWER                    0.706166\n",
       "UNABLE TO OBTAIN                              0.361695\n",
       "MIDDLE EASTERN                                0.241130\n",
       "PORTUGUESE                                    0.206683\n",
       "AMERICAN INDIAN/ALASKA NATIVE                 0.137788\n",
       "MULTI RACE ETHNICITY                          0.120565\n",
       "NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER     0.034447\n",
       "dtype: float64"
      ]
     },
     "execution_count": 112,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "race3_prop.sort_values(ascending=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 113,
   "id": "f04e8cf1-2bf9-427f-b450-cc72c3d335a0",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ETHNICITY\n",
       "WHITE                                        4130\n",
       "BLACK                                         790\n",
       "UNKNOWN/NOT SPECIFIED                         238\n",
       "ASIAN                                         205\n",
       "HISPANIC OR LATINO                            203\n",
       "OTHER                                         135\n",
       "PATIENT DECLINED TO ANSWER                     41\n",
       "UNABLE TO OBTAIN                               21\n",
       "MIDDLE EASTERN                                 14\n",
       "PORTUGUESE                                     12\n",
       "AMERICAN INDIAN/ALASKA NATIVE                   8\n",
       "MULTI RACE ETHNICITY                            7\n",
       "NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER       2\n",
       "dtype: int64"
      ]
     },
     "execution_count": 113,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "race3.sort_values(ascending=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 114,
   "id": "2ccfa0a7-ff5c-4b75-bff7-8ed17768093e",
   "metadata": {},
   "outputs": [],
   "source": [
    "# female\n",
    "race3_f = nvte_uid[nvte_uid['GENDER'] == 'F'].groupby('ETHNICITY').size()\n",
    "race3_f_prop = race3_f.div(len(nvte_uid[nvte_uid['GENDER'] == 'F']))*100"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 115,
   "id": "f04e67a7-00b4-4ab5-93e0-6a5f7244a941",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ETHNICITY\n",
       "WHITE                                        68.878996\n",
       "BLACK                                        17.725617\n",
       "ASIAN                                         3.804128\n",
       "UNKNOWN/NOT SPECIFIED                         3.237556\n",
       "HISPANIC OR LATINO                            2.792392\n",
       "OTHER                                         2.347228\n",
       "PATIENT DECLINED TO ANSWER                    0.566572\n",
       "UNABLE TO OBTAIN                              0.323756\n",
       "AMERICAN INDIAN/ALASKA NATIVE                 0.161878\n",
       "MULTI RACE ETHNICITY                          0.080939\n",
       "NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER     0.080939\n",
       "dtype: float64"
      ]
     },
     "execution_count": 115,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "race3_f_prop.sort_values(ascending=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 116,
   "id": "5318c8b1-dab9-4ee0-b3d8-463ba23f8a23",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ETHNICITY\n",
       "WHITE                                        1702\n",
       "BLACK                                         438\n",
       "ASIAN                                          94\n",
       "UNKNOWN/NOT SPECIFIED                          80\n",
       "HISPANIC OR LATINO                             69\n",
       "OTHER                                          58\n",
       "PATIENT DECLINED TO ANSWER                     14\n",
       "UNABLE TO OBTAIN                                8\n",
       "AMERICAN INDIAN/ALASKA NATIVE                   4\n",
       "MULTI RACE ETHNICITY                            2\n",
       "NATIVE HAWAIIAN OR OTHER PACIFIC ISLANDER       2\n",
       "dtype: int64"
      ]
     },
     "execution_count": 116,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "race3_f.sort_values(ascending=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 117,
   "id": "48def21d-90cd-4292-bafa-98700778a300",
   "metadata": {},
   "outputs": [],
   "source": [
    "# male\n",
    "race3_m = nvte_uid[nvte_uid['GENDER'] == 'M'].groupby('ETHNICITY').size()\n",
    "race3_m_prop = race3_m.div(len(nvte_uid[nvte_uid['GENDER'] == 'M']))*100"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 118,
   "id": "ecc5b8be-0301-499d-ac3b-998c206a28da",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ETHNICITY\n",
       "WHITE                            72.803598\n",
       "BLACK                            10.554723\n",
       "UNKNOWN/NOT SPECIFIED             4.737631\n",
       "HISPANIC OR LATINO                4.017991\n",
       "ASIAN                             3.328336\n",
       "OTHER                             2.308846\n",
       "PATIENT DECLINED TO ANSWER        0.809595\n",
       "MIDDLE EASTERN                    0.419790\n",
       "UNABLE TO OBTAIN                  0.389805\n",
       "PORTUGUESE                        0.359820\n",
       "MULTI RACE ETHNICITY              0.149925\n",
       "AMERICAN INDIAN/ALASKA NATIVE     0.119940\n",
       "dtype: float64"
      ]
     },
     "execution_count": 118,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "race3_m_prop.sort_values(ascending=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 119,
   "id": "07214df7-ec15-4a8f-bd1d-aa6a3b4b6ae5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "ETHNICITY\n",
       "WHITE                            2428\n",
       "BLACK                             352\n",
       "UNKNOWN/NOT SPECIFIED             158\n",
       "HISPANIC OR LATINO                134\n",
       "ASIAN                             111\n",
       "OTHER                              77\n",
       "PATIENT DECLINED TO ANSWER         27\n",
       "MIDDLE EASTERN                     14\n",
       "UNABLE TO OBTAIN                   13\n",
       "PORTUGUESE                         12\n",
       "MULTI RACE ETHNICITY                5\n",
       "AMERICAN INDIAN/ALASKA NATIVE       4\n",
       "dtype: int64"
      ]
     },
     "execution_count": 119,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "race3_m.sort_values(ascending=False)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "2ca4a1dd-40fe-41d2-9293-144d139f15a0",
   "metadata": {
    "jp-MarkdownHeadingCollapsed": true,
    "tags": []
   },
   "source": [
    "#### Age"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 120,
   "id": "f718547b-4482-431c-a786-a65ca7eb5f69",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    5806.000000\n",
       "mean       68.568722\n",
       "std        55.332197\n",
       "min         0.000000\n",
       "25%        49.000000\n",
       "50%        64.000000\n",
       "75%        77.000000\n",
       "max       310.000000\n",
       "Name: AGE, dtype: float64"
      ]
     },
     "execution_count": 120,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nvte_uid['AGE'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 121,
   "id": "fcf10a45-eaf6-4368-b653-99179f0121e7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    2471.000000\n",
       "mean       70.396601\n",
       "std        60.712721\n",
       "min         0.000000\n",
       "25%        47.000000\n",
       "50%        64.000000\n",
       "75%        77.000000\n",
       "max       310.000000\n",
       "Name: AGE, dtype: float64"
      ]
     },
     "execution_count": 121,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# female\n",
    "nvte_uid['AGE'][nvte_uid['GENDER'] == 'F'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 122,
   "id": "23d17d81-aa5e-4471-bdb1-6ea216a5699d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    3335.000000\n",
       "mean       67.214393\n",
       "std        50.947859\n",
       "min         0.000000\n",
       "25%        50.000000\n",
       "50%        63.000000\n",
       "75%        76.000000\n",
       "max       308.000000\n",
       "Name: AGE, dtype: float64"
      ]
     },
     "execution_count": 122,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nvte_uid['AGE'][nvte_uid['GENDER'] == 'M'].describe()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f5145fd1-a266-47da-9c66-9ad8ab394a16",
   "metadata": {
    "jp-MarkdownHeadingCollapsed": true,
    "tags": []
   },
   "source": [
    "#### Length Stay"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 123,
   "id": "6c5367f0-ca26-45f9-973f-8624091fcaf2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    5806.000000\n",
       "mean       11.493111\n",
       "std        13.441392\n",
       "min         0.000000\n",
       "25%         4.000000\n",
       "50%         7.000000\n",
       "75%        14.000000\n",
       "max       140.000000\n",
       "Name: LENGTH_STAY, dtype: float64"
      ]
     },
     "execution_count": 123,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nvte_uid['LENGTH_STAY'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 124,
   "id": "92dd617d-a614-433d-ab80-d0ac3a964fcf",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    2471.000000\n",
       "mean       11.302711\n",
       "std        13.751608\n",
       "min         0.000000\n",
       "25%         4.000000\n",
       "50%         7.000000\n",
       "75%        13.000000\n",
       "max       140.000000\n",
       "Name: LENGTH_STAY, dtype: float64"
      ]
     },
     "execution_count": 124,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# female\n",
    "nvte_uid['LENGTH_STAY'][nvte_uid['GENDER'] == 'F'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 125,
   "id": "aca584f1-e92f-483a-8d26-62f149604ebb",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    3335.000000\n",
       "mean       11.634183\n",
       "std        13.207151\n",
       "min         0.000000\n",
       "25%         4.000000\n",
       "50%         7.000000\n",
       "75%        14.000000\n",
       "max       138.000000\n",
       "Name: LENGTH_STAY, dtype: float64"
      ]
     },
     "execution_count": 125,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# male\n",
    "nvte_uid['LENGTH_STAY'][nvte_uid['GENDER'] == 'M'].describe()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5e2ccade-c276-4371-b9cc-02d9318f2970",
   "metadata": {
    "jp-MarkdownHeadingCollapsed": true,
    "tags": []
   },
   "source": [
    "#### Admit Times"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 126,
   "id": "c66908bf-2aa3-42d4-ab29-75f14f5c0cfe",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    5806.000000\n",
       "mean        3.951085\n",
       "std         4.511715\n",
       "min         2.000000\n",
       "25%         2.000000\n",
       "50%         3.000000\n",
       "75%         4.000000\n",
       "max        42.000000\n",
       "Name: ADMIT_TIMES, dtype: float64"
      ]
     },
     "execution_count": 126,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nvte_uid['ADMIT_TIMES'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 127,
   "id": "202918b5-6aa3-4d30-8d67-2cdef527f11a",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    2471.000000\n",
       "mean        4.093889\n",
       "std         4.575601\n",
       "min         2.000000\n",
       "25%         2.000000\n",
       "50%         3.000000\n",
       "75%         4.000000\n",
       "max        34.000000\n",
       "Name: ADMIT_TIMES, dtype: float64"
      ]
     },
     "execution_count": 127,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# female\n",
    "nvte_uid['ADMIT_TIMES'][nvte_uid['GENDER'] == 'F'].describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 128,
   "id": "d3eaa71e-2e0f-4285-a4cf-70b107a05d83",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    3335.000000\n",
       "mean        3.845277\n",
       "std         4.461532\n",
       "min         2.000000\n",
       "25%         2.000000\n",
       "50%         3.000000\n",
       "75%         4.000000\n",
       "max        42.000000\n",
       "Name: ADMIT_TIMES, dtype: float64"
      ]
     },
     "execution_count": 128,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# male\n",
    "nvte_uid['ADMIT_TIMES'][nvte_uid['GENDER'] == 'M'].describe()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "0857e25e-b1eb-4a56-b8cf-c993989ea079",
   "metadata": {
    "jp-MarkdownHeadingCollapsed": true,
    "tags": []
   },
   "source": [
    "#### Readmit Days"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 129,
   "id": "512c1472-b916-4509-86b9-1fdbeb1a6d03",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    3164.000000\n",
       "mean       11.559418\n",
       "std         8.391952\n",
       "min         1.000000\n",
       "25%         4.000000\n",
       "50%        10.000000\n",
       "75%        18.000000\n",
       "max        29.000000\n",
       "Name: READMIT_DAY, dtype: float64"
      ]
     },
     "execution_count": 129,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nvte_uid[nvte_uid['READMIT_DAY'] > 0].READMIT_DAY.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 130,
   "id": "8537bde2-6ecf-412c-9bd0-3930e6299b51",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    1361.000000\n",
       "mean       11.508450\n",
       "std         8.234618\n",
       "min         1.000000\n",
       "25%         4.000000\n",
       "50%        10.000000\n",
       "75%        18.000000\n",
       "max        29.000000\n",
       "Name: READMIT_DAY, dtype: float64"
      ]
     },
     "execution_count": 130,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# female\n",
    "nvte_uid[(nvte_uid['READMIT_DAY'] > 0) & (nvte_uid['GENDER'] == 'F')].READMIT_DAY.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 131,
   "id": "ae1dd15b-73e2-4a09-92e3-b33952806428",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "count    1803.000000\n",
       "mean       11.597892\n",
       "std         8.510862\n",
       "min         1.000000\n",
       "25%         4.000000\n",
       "50%        10.000000\n",
       "75%        18.000000\n",
       "max        29.000000\n",
       "Name: READMIT_DAY, dtype: float64"
      ]
     },
     "execution_count": 131,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# male\n",
    "nvte_uid[(nvte_uid['READMIT_DAY'] > 0) & (nvte_uid['GENDER'] == 'M')].READMIT_DAY.describe()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "63941a2f-450e-4508-b793-e91500c0da7f",
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "markdown",
   "id": "849237c9-489d-48f3-aa85-7114f87f3b07",
   "metadata": {
    "jp-MarkdownHeadingCollapsed": true,
    "tags": []
   },
   "source": [
    "# Comorbidities in Group I"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 177,
   "id": "7b8e03c5-79d8-4976-8458-f0f94c3bab60",
   "metadata": {},
   "outputs": [],
   "source": [
    "other_code = df_dia_icd[~df_dia_icd.ICD9_CODE.isin(lista)][['SUBJECT_ID', 'HADM_ID', 'ICD9_CODE']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 178,
   "id": "937810a5-24cf-4ee7-9c25-e0b9d51b5154",
   "metadata": {},
   "outputs": [],
   "source": [
    "vte_com = pd.merge(vte_uid, other_code, how='inner', on = ['SUBJECT_ID', 'HADM_ID'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 179,
   "id": "62d84daa-ddbb-4f4d-a342-1645661fc694",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>SUBJECT_ID</th>\n",
       "      <th>HADM_ID</th>\n",
       "      <th>ICD9_CODE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>109</td>\n",
       "      <td>172335</td>\n",
       "      <td>40301</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>109</td>\n",
       "      <td>172335</td>\n",
       "      <td>486</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>109</td>\n",
       "      <td>172335</td>\n",
       "      <td>58281</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>109</td>\n",
       "      <td>172335</td>\n",
       "      <td>5855</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>109</td>\n",
       "      <td>172335</td>\n",
       "      <td>4254</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   SUBJECT_ID  HADM_ID ICD9_CODE\n",
       "0         109   172335     40301\n",
       "1         109   172335       486\n",
       "2         109   172335     58281\n",
       "3         109   172335      5855\n",
       "4         109   172335      4254"
      ]
     },
     "execution_count": 179,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "other_code.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 180,
   "id": "88f90911-183e-4854-a104-a2614fd790fb",
   "metadata": {},
   "outputs": [],
   "source": [
    "vte_top5_com = vte_com['ICD9_CODE'].value_counts()[:5].sort_values(ascending=False).index.tolist()[:5]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 181,
   "id": "37fe1360-2944-44fb-941f-78b89a6103f2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['4280', '4019', '42731', '51881', '5849']"
      ]
     },
     "execution_count": 181,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vte_top5_com"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "83f7af1e-3e98-4b6c-b604-871336395bbe",
   "metadata": {},
   "source": [
    "['Congestive heart failure, unspecified', 'Unspecified essential hypertension', 'Atrial fibrillation', 'Acute respiratory failure', 'Acute kidney failure, unspecified']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 182,
   "id": "b49a085f-e2c7-4307-b346-d532a2c84c35",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>SUBJECT_ID</th>\n",
       "      <th>HADM_ID</th>\n",
       "      <th>SEQ_NUM</th>\n",
       "      <th>ADMITTIME</th>\n",
       "      <th>DISCHTIME</th>\n",
       "      <th>DEATHTIME</th>\n",
       "      <th>ADMISSION_TYPE</th>\n",
       "      <th>ADMISSION_LOCATION</th>\n",
       "      <th>DISCHARGE_LOCATION</th>\n",
       "      <th>INSURANCE</th>\n",
       "      <th>...</th>\n",
       "      <th>DOD</th>\n",
       "      <th>DOD_HOSP</th>\n",
       "      <th>DOD_SSN</th>\n",
       "      <th>EXPIRE_FLAG</th>\n",
       "      <th>AGE</th>\n",
       "      <th>ADMIT_TIMES</th>\n",
       "      <th>LENGTH_STAY</th>\n",
       "      <th>AGE_RANGE</th>\n",
       "      <th>READMIT_DAY</th>\n",
       "      <th>ICD9_CODE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>32810</td>\n",
       "      <td>168208</td>\n",
       "      <td>5.0</td>\n",
       "      <td>2100-10-29</td>\n",
       "      <td>2100-11-05</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>EMERGENCY ROOM ADMIT</td>\n",
       "      <td>REHAB/DISTINCT PART HOSP</td>\n",
       "      <td>Medicaid</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>22</td>\n",
       "      <td>2</td>\n",
       "      <td>7</td>\n",
       "      <td>[20-29]</td>\n",
       "      <td>3</td>\n",
       "      <td>9999</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>32810</td>\n",
       "      <td>168208</td>\n",
       "      <td>5.0</td>\n",
       "      <td>2100-10-29</td>\n",
       "      <td>2100-11-05</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>EMERGENCY ROOM ADMIT</td>\n",
       "      <td>REHAB/DISTINCT PART HOSP</td>\n",
       "      <td>Medicaid</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>22</td>\n",
       "      <td>2</td>\n",
       "      <td>7</td>\n",
       "      <td>[20-29]</td>\n",
       "      <td>3</td>\n",
       "      <td>48281</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>32810</td>\n",
       "      <td>168208</td>\n",
       "      <td>5.0</td>\n",
       "      <td>2100-10-29</td>\n",
       "      <td>2100-11-05</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>EMERGENCY ROOM ADMIT</td>\n",
       "      <td>REHAB/DISTINCT PART HOSP</td>\n",
       "      <td>Medicaid</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>22</td>\n",
       "      <td>2</td>\n",
       "      <td>7</td>\n",
       "      <td>[20-29]</td>\n",
       "      <td>3</td>\n",
       "      <td>5070</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>32810</td>\n",
       "      <td>168208</td>\n",
       "      <td>5.0</td>\n",
       "      <td>2100-10-29</td>\n",
       "      <td>2100-11-05</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>EMERGENCY ROOM ADMIT</td>\n",
       "      <td>REHAB/DISTINCT PART HOSP</td>\n",
       "      <td>Medicaid</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>22</td>\n",
       "      <td>2</td>\n",
       "      <td>7</td>\n",
       "      <td>[20-29]</td>\n",
       "      <td>3</td>\n",
       "      <td>3481</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>32810</td>\n",
       "      <td>168208</td>\n",
       "      <td>5.0</td>\n",
       "      <td>2100-10-29</td>\n",
       "      <td>2100-11-05</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>EMERGENCY ROOM ADMIT</td>\n",
       "      <td>REHAB/DISTINCT PART HOSP</td>\n",
       "      <td>Medicaid</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>22</td>\n",
       "      <td>2</td>\n",
       "      <td>7</td>\n",
       "      <td>[20-29]</td>\n",
       "      <td>3</td>\n",
       "      <td>2763</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 31 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   SUBJECT_ID  HADM_ID  SEQ_NUM   ADMITTIME   DISCHTIME DEATHTIME  \\\n",
       "0       32810   168208      5.0  2100-10-29  2100-11-05       NaN   \n",
       "1       32810   168208      5.0  2100-10-29  2100-11-05       NaN   \n",
       "2       32810   168208      5.0  2100-10-29  2100-11-05       NaN   \n",
       "3       32810   168208      5.0  2100-10-29  2100-11-05       NaN   \n",
       "4       32810   168208      5.0  2100-10-29  2100-11-05       NaN   \n",
       "\n",
       "  ADMISSION_TYPE    ADMISSION_LOCATION        DISCHARGE_LOCATION INSURANCE  \\\n",
       "0      EMERGENCY  EMERGENCY ROOM ADMIT  REHAB/DISTINCT PART HOSP  Medicaid   \n",
       "1      EMERGENCY  EMERGENCY ROOM ADMIT  REHAB/DISTINCT PART HOSP  Medicaid   \n",
       "2      EMERGENCY  EMERGENCY ROOM ADMIT  REHAB/DISTINCT PART HOSP  Medicaid   \n",
       "3      EMERGENCY  EMERGENCY ROOM ADMIT  REHAB/DISTINCT PART HOSP  Medicaid   \n",
       "4      EMERGENCY  EMERGENCY ROOM ADMIT  REHAB/DISTINCT PART HOSP  Medicaid   \n",
       "\n",
       "   ...  DOD DOD_HOSP DOD_SSN EXPIRE_FLAG AGE ADMIT_TIMES LENGTH_STAY  \\\n",
       "0  ...  NaN      NaN     NaN           0  22           2           7   \n",
       "1  ...  NaN      NaN     NaN           0  22           2           7   \n",
       "2  ...  NaN      NaN     NaN           0  22           2           7   \n",
       "3  ...  NaN      NaN     NaN           0  22           2           7   \n",
       "4  ...  NaN      NaN     NaN           0  22           2           7   \n",
       "\n",
       "   AGE_RANGE  READMIT_DAY ICD9_CODE  \n",
       "0    [20-29]            3      9999  \n",
       "1    [20-29]            3     48281  \n",
       "2    [20-29]            3      5070  \n",
       "3    [20-29]            3      3481  \n",
       "4    [20-29]            3      2763  \n",
       "\n",
       "[5 rows x 31 columns]"
      ]
     },
     "execution_count": 182,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vte_com.head()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "affcb2d8-deea-4556-a8e4-6fe31e4f4bc3",
   "metadata": {
    "tags": []
   },
   "source": [
    "# Comorbidities in Group II"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 183,
   "id": "98b539a6-81a7-4158-8e8c-82ba0b4f340a",
   "metadata": {},
   "outputs": [],
   "source": [
    "nvte_com = pd.merge(nvte_uid, other_code, how='inner', on = ['SUBJECT_ID', 'HADM_ID'])\n",
    "nvte_top5_com = nvte_com['ICD9_CODE'].value_counts()[:5].sort_values(ascending=False).index.tolist()[:5]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 184,
   "id": "029e5d12-619b-41ec-9df4-50fb7a89bba2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['4019', '4280', '42731', '5849', '41401']"
      ]
     },
     "execution_count": 184,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nvte_top5_com"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "da0a837f-af1d-4a3f-a896-a34eb29d5eba",
   "metadata": {},
   "source": [
    "['Unspecified essential hypertension', 'Congestive heart failure, unspecified', 'Atrial fibrillation', 'Acute kidney failure, unspecified', 'Coronary atherosclerosis of native coronary artery']"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "566e6060-7073-48b1-ab16-b7f7774ef137",
   "metadata": {
    "tags": []
   },
   "source": [
    "# Medications in Group I"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 185,
   "id": "1c1fa103-8b70-473b-a05a-02717565ba24",
   "metadata": {},
   "outputs": [],
   "source": [
    "presc_sub = df_presc[['SUBJECT_ID', 'HADM_ID','DRUG_TYPE', 'DRUG', 'NDC']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 186,
   "id": "848d87e3-9bac-445a-8cc5-dbbe70132dbb",
   "metadata": {},
   "outputs": [],
   "source": [
    "vte_med = pd.merge(vte_uid, presc_sub, how='inner', on = ['SUBJECT_ID', 'HADM_ID'])\n",
    "vte_med['NDC'] = vte_med['NDC'].astype(str)\n",
    "vte_med_main = vte_med[vte_med['DRUG_TYPE'] == 'MAIN']\n",
    "vte_med_base = vte_med[vte_med['DRUG_TYPE'] == 'BASE']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 187,
   "id": "dafcf2b8-c7a1-42df-8b59-7060923ef5d5",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(25375, 33)"
      ]
     },
     "execution_count": 187,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vte_med.shape"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "52de254e-4096-4428-b926-87602324760c",
   "metadata": {},
   "source": [
    "#### Main"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 188,
   "id": "afdbb6a3-4320-47c7-b72d-06ad73b40142",
   "metadata": {},
   "outputs": [],
   "source": [
    "# main drug type\n",
    "vte_top5_med_main = vte_med_main['NDC'].value_counts()[:5].sort_values(ascending=False).index.tolist()[:5]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 189,
   "id": "bb5e3765-67fe-45d6-b3db-407d6fb85997",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['0.0', '517570425.0', '338055002.0', '409672924.0', '338070341.0']"
      ]
     },
     "execution_count": 189,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vte_top5_med_main"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 190,
   "id": "5d44292a-f4dd-4ed9-82b9-6c403ac9f01f",
   "metadata": {},
   "outputs": [],
   "source": [
    "a = vte_med_main[vte_med_main['NDC'] == '0.0'].DRUG.unique()\n",
    "b = vte_med_main[vte_med_main['NDC'] == '517570425.0'].DRUG.unique()\n",
    "c = vte_med_main[vte_med_main['NDC'] == '338055002.0'].DRUG.unique()\n",
    "d = vte_med_main[vte_med_main['NDC'] == '409672924.0'].DRUG.unique()\n",
    "e = vte_med_main[vte_med_main['NDC'] == '338070341.0'].DRUG.unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 191,
   "id": "71584bb7-3a4a-4233-88e9-b4871d6eb91c",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Top5 Main Drug Name in group 1:\n",
      " 1:  ['Sodium Chloride 0.9%  Flush' 'Insulin' 'Normocarb' 'Prismasate (B32 K2)'\n",
      " 'Prismasate (B22 K4)' 'Sodium CITRATE 4%'\n",
      " 'Maalox/Diphenhydramine/Lidocaine' 'Sodium Citrate 4%'\n",
      " 'Papain 2.5 % Solution' 'Transplant Self Medication Program'\n",
      " 'Bupivacaine 0.1%' 'Maalox/Benadryl/Lidocaine'\n",
      " 'N-Acetylcysteine Study Drug'] \n",
      "2:  ['Furosemide'] \n",
      "3:  ['Heparin Sodium'] \n",
      "4:  ['Magnesium Sulfate' 'Magnesium Sulfate Replacement (Oncology)'] \n",
      "5:  ['Potassium Chloride']\n"
     ]
    }
   ],
   "source": [
    "print('Top5 Main Drug Name in group 1:\\n 1: ', a, '\\n2: ', b, '\\n3: ', c, '\\n4: ', d, '\\n5: ', e)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "33d682af-ebe2-4746-af12-c9a52b08e9b4",
   "metadata": {
    "tags": []
   },
   "source": [
    "# Medication in Group II"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 192,
   "id": "55546c21-d030-4edb-afb9-d0cd04684f5e",
   "metadata": {},
   "outputs": [],
   "source": [
    "nvte_med = pd.merge(nvte_uid, presc_sub, how='inner', on = ['SUBJECT_ID', 'HADM_ID'])\n",
    "nvte_med['NDC'] = nvte_med['NDC'].astype(str)\n",
    "nvte_med_main = nvte_med[nvte_med['DRUG_TYPE'] == 'MAIN']\n",
    "nvte_med_base = nvte_med[nvte_med['DRUG_TYPE'] == 'BASE']"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "75b84579-5918-407b-b79a-68bfa2434e3a",
   "metadata": {},
   "source": [
    "#### Main"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 193,
   "id": "2c26d364-c404-4c5a-a800-a240e1e723fe",
   "metadata": {},
   "outputs": [],
   "source": [
    "# main drug type\n",
    "nvte_top5_med_main = nvte_med_main['NDC'].value_counts()[:5].sort_values(ascending=False).index.tolist()[:5]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 194,
   "id": "4747383a-5aeb-470a-a00a-949ad1e3b0db",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['0.0', '517570425.0', '409672924.0', '338070341.0', '338355248.0']"
      ]
     },
     "execution_count": 194,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nvte_top5_med_main"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "db5d81f8-c697-4770-b2e0-abe2771dbf07",
   "metadata": {
    "jp-MarkdownHeadingCollapsed": true,
    "tags": []
   },
   "source": [
    "# Procedures in Group I"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 206,
   "id": "a1c32906-43ff-42d8-b116-9a44aedf3a0d",
   "metadata": {},
   "outputs": [],
   "source": [
    "df_proce = df_proce.drop(['ROW_ID', 'SEQ_NUM'],axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 207,
   "id": "11da2e97-bbc5-45b7-bc29-13cd88e7868f",
   "metadata": {},
   "outputs": [],
   "source": [
    "vte_proce = pd.merge(vte_uid, df_proce, how='inner', on = ['SUBJECT_ID', 'HADM_ID'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 209,
   "id": "910d69ef-adce-4aac-9eb5-3d2178a7bba8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>SUBJECT_ID</th>\n",
       "      <th>HADM_ID</th>\n",
       "      <th>SEQ_NUM</th>\n",
       "      <th>ADMITTIME</th>\n",
       "      <th>DISCHTIME</th>\n",
       "      <th>DEATHTIME</th>\n",
       "      <th>ADMISSION_TYPE</th>\n",
       "      <th>ADMISSION_LOCATION</th>\n",
       "      <th>DISCHARGE_LOCATION</th>\n",
       "      <th>INSURANCE</th>\n",
       "      <th>...</th>\n",
       "      <th>DOD</th>\n",
       "      <th>DOD_HOSP</th>\n",
       "      <th>DOD_SSN</th>\n",
       "      <th>EXPIRE_FLAG</th>\n",
       "      <th>AGE</th>\n",
       "      <th>ADMIT_TIMES</th>\n",
       "      <th>LENGTH_STAY</th>\n",
       "      <th>AGE_RANGE</th>\n",
       "      <th>READMIT_DAY</th>\n",
       "      <th>ICD9_CODE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>32810</td>\n",
       "      <td>168208</td>\n",
       "      <td>5.0</td>\n",
       "      <td>2100-10-29</td>\n",
       "      <td>2100-11-05</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>EMERGENCY ROOM ADMIT</td>\n",
       "      <td>REHAB/DISTINCT PART HOSP</td>\n",
       "      <td>Medicaid</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>22</td>\n",
       "      <td>2</td>\n",
       "      <td>7</td>\n",
       "      <td>[20-29]</td>\n",
       "      <td>3</td>\n",
       "      <td>966</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>32810</td>\n",
       "      <td>168208</td>\n",
       "      <td>5.0</td>\n",
       "      <td>2100-10-29</td>\n",
       "      <td>2100-11-05</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>EMERGENCY ROOM ADMIT</td>\n",
       "      <td>REHAB/DISTINCT PART HOSP</td>\n",
       "      <td>Medicaid</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>22</td>\n",
       "      <td>2</td>\n",
       "      <td>7</td>\n",
       "      <td>[20-29]</td>\n",
       "      <td>3</td>\n",
       "      <td>3893</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>32810</td>\n",
       "      <td>189751</td>\n",
       "      <td>11.0</td>\n",
       "      <td>2100-09-18</td>\n",
       "      <td>2100-10-26</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>EMERGENCY ROOM ADMIT</td>\n",
       "      <td>REHAB/DISTINCT PART HOSP</td>\n",
       "      <td>Medicaid</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>22</td>\n",
       "      <td>2</td>\n",
       "      <td>38</td>\n",
       "      <td>[20-29]</td>\n",
       "      <td>0</td>\n",
       "      <td>311</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>32810</td>\n",
       "      <td>189751</td>\n",
       "      <td>11.0</td>\n",
       "      <td>2100-09-18</td>\n",
       "      <td>2100-10-26</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>EMERGENCY ROOM ADMIT</td>\n",
       "      <td>REHAB/DISTINCT PART HOSP</td>\n",
       "      <td>Medicaid</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>22</td>\n",
       "      <td>2</td>\n",
       "      <td>38</td>\n",
       "      <td>[20-29]</td>\n",
       "      <td>0</td>\n",
       "      <td>4311</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>32810</td>\n",
       "      <td>189751</td>\n",
       "      <td>11.0</td>\n",
       "      <td>2100-09-18</td>\n",
       "      <td>2100-10-26</td>\n",
       "      <td>NaN</td>\n",
       "      <td>EMERGENCY</td>\n",
       "      <td>EMERGENCY ROOM ADMIT</td>\n",
       "      <td>REHAB/DISTINCT PART HOSP</td>\n",
       "      <td>Medicaid</td>\n",
       "      <td>...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>0</td>\n",
       "      <td>22</td>\n",
       "      <td>2</td>\n",
       "      <td>38</td>\n",
       "      <td>[20-29]</td>\n",
       "      <td>0</td>\n",
       "      <td>110</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 31 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   SUBJECT_ID  HADM_ID  SEQ_NUM   ADMITTIME   DISCHTIME DEATHTIME  \\\n",
       "0       32810   168208      5.0  2100-10-29  2100-11-05       NaN   \n",
       "1       32810   168208      5.0  2100-10-29  2100-11-05       NaN   \n",
       "2       32810   189751     11.0  2100-09-18  2100-10-26       NaN   \n",
       "3       32810   189751     11.0  2100-09-18  2100-10-26       NaN   \n",
       "4       32810   189751     11.0  2100-09-18  2100-10-26       NaN   \n",
       "\n",
       "  ADMISSION_TYPE    ADMISSION_LOCATION        DISCHARGE_LOCATION INSURANCE  \\\n",
       "0      EMERGENCY  EMERGENCY ROOM ADMIT  REHAB/DISTINCT PART HOSP  Medicaid   \n",
       "1      EMERGENCY  EMERGENCY ROOM ADMIT  REHAB/DISTINCT PART HOSP  Medicaid   \n",
       "2      EMERGENCY  EMERGENCY ROOM ADMIT  REHAB/DISTINCT PART HOSP  Medicaid   \n",
       "3      EMERGENCY  EMERGENCY ROOM ADMIT  REHAB/DISTINCT PART HOSP  Medicaid   \n",
       "4      EMERGENCY  EMERGENCY ROOM ADMIT  REHAB/DISTINCT PART HOSP  Medicaid   \n",
       "\n",
       "   ...  DOD DOD_HOSP DOD_SSN EXPIRE_FLAG AGE ADMIT_TIMES LENGTH_STAY  \\\n",
       "0  ...  NaN      NaN     NaN           0  22           2           7   \n",
       "1  ...  NaN      NaN     NaN           0  22           2           7   \n",
       "2  ...  NaN      NaN     NaN           0  22           2          38   \n",
       "3  ...  NaN      NaN     NaN           0  22           2          38   \n",
       "4  ...  NaN      NaN     NaN           0  22           2          38   \n",
       "\n",
       "   AGE_RANGE  READMIT_DAY ICD9_CODE  \n",
       "0    [20-29]            3       966  \n",
       "1    [20-29]            3      3893  \n",
       "2    [20-29]            0       311  \n",
       "3    [20-29]            0      4311  \n",
       "4    [20-29]            0       110  \n",
       "\n",
       "[5 rows x 31 columns]"
      ]
     },
     "execution_count": 209,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vte_proce.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 210,
   "id": "27113b61-40d2-43e5-a0b0-48774ff26d74",
   "metadata": {},
   "outputs": [],
   "source": [
    "vte_proce = vte_proce.drop(['SEQ_NUM'],axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 211,
   "id": "097998cf-7501-4506-b3f4-badbbb39a964",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(1286, 30)"
      ]
     },
     "execution_count": 211,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vte_proce.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 212,
   "id": "2bf56195-d65f-4d6a-bd46-87aaeb7ba3f3",
   "metadata": {},
   "outputs": [],
   "source": [
    "vte_top5_pro = vte_proce['ICD9_CODE'].value_counts()[:5].sort_values(ascending=False).index.tolist()[:5]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 213,
   "id": "79c13942-6fa9-4d92-80b0-9a06a292813f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[3893, 966, 9904, 9604, 9672]"
      ]
     },
     "execution_count": 213,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vte_top5_pro"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "315f060a-8b05-4c23-99ae-23af727f0751",
   "metadata": {
    "jp-MarkdownHeadingCollapsed": true,
    "tags": []
   },
   "source": [
    "# Procedures in Group II"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 214,
   "id": "a3dfeb75-b7fc-406a-b0d2-b0844ea6c4d8",
   "metadata": {},
   "outputs": [],
   "source": [
    "proce_sub = df_proce[['SUBJECT_ID', 'HADM_ID', 'ICD9_CODE']]\n",
    "proce_sub['ICD9_CODE'] = proce_sub['ICD9_CODE'].astype(str)\n",
    "df_d_proce['ICD9_CODE'] = df_d_proce['ICD9_CODE'].astype(str)\n",
    "df_d_proce = df_d_proce.drop('ROW_ID', axis=1)\n",
    "nvte_proce = pd.merge(nvte_uid, proce_sub, how='inner', on = ['SUBJECT_ID', 'HADM_ID'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 215,
   "id": "f2602fee-a0d8-477e-aeb5-96eba6c975c1",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(23933, 29)"
      ]
     },
     "execution_count": 215,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nvte_proce.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 216,
   "id": "0c53a271-9c13-4bcb-bc6c-7db71b2e0998",
   "metadata": {},
   "outputs": [],
   "source": [
    "nvte_top5_pro = nvte_proce['ICD9_CODE'].value_counts()[:5].sort_values(ascending=False).index.tolist()[:5]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 217,
   "id": "ea11acbe-9411-4870-bbdd-2910f1ab0db3",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "['3893', '966', '9604', '9904', '9671']"
      ]
     },
     "execution_count": 217,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nvte_top5_pro"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 218,
   "id": "876321fe-43cd-4fb0-989c-3bf2d7f519e7",
   "metadata": {},
   "outputs": [],
   "source": [
    "A = df_d_proce[df_d_proce['ICD9_CODE'] == '3893'].SHORT_TITLE.to_string(index=False)\n",
    "B = df_d_proce[df_d_proce['ICD9_CODE'] == '966'].SHORT_TITLE.to_string(index=False)\n",
    "C = df_d_proce[df_d_proce['ICD9_CODE'] == '9904'].SHORT_TITLE.to_string(index=False)\n",
    "D = df_d_proce[df_d_proce['ICD9_CODE'] == '9604'].SHORT_TITLE.to_string(index=False)\n",
    "E1 = df_d_proce[df_d_proce['ICD9_CODE'] == '9672'].SHORT_TITLE.to_string(index=False)\n",
    "E2 = df_d_proce[df_d_proce['ICD9_CODE'] == '9671'].SHORT_TITLE.to_string(index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 219,
   "id": "2f913bde-5d1f-42e3-b935-d528fe511b5d",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "3893:  Venous cath NEC \n",
      "966:  Entral infus nutrit sub \n",
      "9904:  Packed cell transfusion \n",
      "9604:  Insert endotracheal tube \n",
      "9672:  Cont inv mec ven 96+ hrs \n",
      "9671:  Cont inv mec ven <96 hrs\n"
     ]
    }
   ],
   "source": [
    "print('3893: ', A, '\\n966: ', B, '\\n9904: ', C, '\\n9604: ', D, '\\n9672: ', E1, '\\n9671: ', E2)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fb8e6251-59c4-403b-b7b6-9a0742aac76b",
   "metadata": {
    "tags": []
   },
   "source": [
    "# Data Cleaning"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b6e6e6ee-f87a-441b-9ef1-b35c0291f77c",
   "metadata": {
    "tags": []
   },
   "source": [
    "#### Check number of NA in each columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 220,
   "id": "5899415f-06bc-42c6-a211-c54267843d4f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "SUBJECT_ID                0\n",
       "HADM_ID                   0\n",
       "SEQ_NUM                   0\n",
       "ADMITTIME                 0\n",
       "DISCHTIME                 0\n",
       "DEATHTIME               179\n",
       "ADMISSION_TYPE            0\n",
       "ADMISSION_LOCATION        0\n",
       "DISCHARGE_LOCATION        0\n",
       "INSURANCE                 0\n",
       "LANGUAGE                 59\n",
       "RELIGION                  0\n",
       "MARITAL_STATUS            0\n",
       "ETHNICITY                 0\n",
       "EDREGTIME                68\n",
       "EDOUTTIME                68\n",
       "DIAGNOSIS                 0\n",
       "HOSPITAL_EXPIRE_FLAG      0\n",
       "HAS_CHARTEVENTS_DATA      0\n",
       "GENDER                    0\n",
       "DOB                       0\n",
       "DOD                      72\n",
       "DOD_HOSP                106\n",
       "DOD_SSN                  91\n",
       "EXPIRE_FLAG               0\n",
       "AGE                       0\n",
       "ADMIT_TIMES               0\n",
       "LENGTH_STAY               0\n",
       "AGE_RANGE                 0\n",
       "READMIT_DAY               0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 220,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vte_uid.isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 221,
   "id": "a0a421b4-8b1c-40bb-9649-c1b7bd205daf",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(197, 30)"
      ]
     },
     "execution_count": 221,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vte_uid.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 222,
   "id": "65114ee3-5df0-4ad3-9477-2365d9043866",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['ENGL', nan, 'PTUN', 'HAIT', 'SPAN', 'CAPE', 'ARAB', 'RUSS',\n",
       "       'ETHI', 'ITAL'], dtype=object)"
      ]
     },
     "execution_count": 222,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vte_uid['LANGUAGE'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 223,
   "id": "f9939336-1bd4-490f-a3f1-4a00153a8f56",
   "metadata": {},
   "outputs": [],
   "source": [
    "#vte_uid.loc[vte_uid['LANGUAGE'].isna(),['LANGUAGE', 'RELIGION', 'ETHNICITY']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 224,
   "id": "a0886f46-ed2c-4d3f-90f9-7a144c8d1e7b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#vte_uid.loc[vte_uid['ETHNICITY']=='BLACK', ['LANGUAGE', 'RELIGION', 'ETHNICITY']]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bd116f56-86bb-4f19-9fbc-d7849038ff66",
   "metadata": {
    "tags": []
   },
   "source": [
    "#### Check number of NA in each columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 225,
   "id": "63ffabc1-37dc-4489-82fb-0d72b8df3a05",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "SUBJECT_ID                 0\n",
       "HADM_ID                    0\n",
       "ADMITTIME                  0\n",
       "DISCHTIME                  0\n",
       "DEATHTIME               5326\n",
       "ADMISSION_TYPE             0\n",
       "ADMISSION_LOCATION         0\n",
       "DISCHARGE_LOCATION         0\n",
       "INSURANCE                  0\n",
       "LANGUAGE                2112\n",
       "RELIGION                  19\n",
       "MARITAL_STATUS           540\n",
       "ETHNICITY                  0\n",
       "EDREGTIME               2109\n",
       "EDOUTTIME               2109\n",
       "DIAGNOSIS                  8\n",
       "HOSPITAL_EXPIRE_FLAG       0\n",
       "HAS_CHARTEVENTS_DATA       0\n",
       "GENDER                     0\n",
       "DOB                        0\n",
       "DOD                     2636\n",
       "DOD_HOSP                3528\n",
       "DOD_SSN                 3182\n",
       "EXPIRE_FLAG                0\n",
       "AGE                        0\n",
       "ADMIT_TIMES                0\n",
       "LENGTH_STAY                0\n",
       "READMIT_DAY                0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 225,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nvte_uid.isna().sum()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 226,
   "id": "76cf07ae-146f-4863-913f-d87764800aa6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(5806, 28)"
      ]
     },
     "execution_count": 226,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nvte_uid.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 227,
   "id": "34427dee-0c8f-4a14-8953-886dfc997f14",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['NOT SPECIFIED', 'PROTESTANT QUAKER', 'CATHOLIC', 'JEWISH', nan,\n",
       "       'UNOBTAINABLE', 'OTHER', 'EPISCOPALIAN', 'CHRISTIAN SCIENTIST',\n",
       "       'GREEK ORTHODOX', 'BUDDHIST', 'MUSLIM', \"JEHOVAH'S WITNESS\",\n",
       "       'UNITARIAN-UNIVERSALIST', 'HINDU', 'ROMANIAN EAST. ORTH', 'HEBREW',\n",
       "       '7TH DAY ADVENTIST', 'BAPTIST'], dtype=object)"
      ]
     },
     "execution_count": 227,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nvte_uid['RELIGION'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 228,
   "id": "0161c45e-4994-4617-9bc3-795519eb71b6",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['MARRIED', 'SINGLE', 'WIDOWED', nan, 'DIVORCED', 'SEPARATED',\n",
       "       'UNKNOWN (DEFAULT)'], dtype=object)"
      ]
     },
     "execution_count": 228,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nvte_uid['MARITAL_STATUS'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 229,
   "id": "2a258c9a-9442-43ce-95b8-a976b84f54fa",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array(['ENGL', nan, 'PTUN', '*CHI', 'RUSS', 'SPAN', 'PORT', 'VIET',\n",
       "       'HAIT', 'GREE', '*BUR', 'CAMB', 'CAPE', 'ETHI', 'CANT', '*HUN',\n",
       "       'FREN', 'ITAL', 'POLI', 'ARAB', 'MAND', 'SOMA', 'PERS', 'KORE',\n",
       "       '*YID', 'HIND', 'AMER', 'ALBA', 'THAI', '*ARM', '*MOR', '*GUJ'],\n",
       "      dtype=object)"
      ]
     },
     "execution_count": 229,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "nvte_uid['LANGUAGE'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 230,
   "id": "191c4bbf-4ccb-404e-8d6a-812e52d50c97",
   "metadata": {},
   "outputs": [],
   "source": [
    "nvte_uid = nvte_uid.dropna(subset = ['DIAGNOSIS'])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "d0526cd3-d7c9-42df-b284-27ebea504ba1",
   "metadata": {
    "tags": []
   },
   "source": [
    "#### Make all those NaN to \"NOT SPECIFIED\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 231,
   "id": "0b10f8e2-05d6-4ced-836d-a96455316ec1",
   "metadata": {},
   "outputs": [],
   "source": [
    "nvte_uid['RELIGION'] = nvte_uid['RELIGION'].replace(np.nan, \"NOT SPECIFIED\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 232,
   "id": "e87011d3-30c8-460e-9326-ef2085bcb860",
   "metadata": {},
   "outputs": [],
   "source": [
    "nvte_uid['MARITAL_STATUS'] = nvte_uid['MARITAL_STATUS'].replace(np.nan, \"UNKNOWN (DEFAULT)\")"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "fc01ff0a-8c49-4014-abef-c86eda7623e4",
   "metadata": {
    "tags": []
   },
   "source": [
    "#### Check outliers in Age, length stay, admit times, readmit days"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9e1964bf-7dbc-4d7b-aba0-c62e782df22f",
   "metadata": {
    "tags": []
   },
   "source": [
    "##### Age check"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 233,
   "id": "f98bdc58-3b16-44eb-bb77-3dec5d73ba11",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/kexinzhang/opt/anaconda3/lib/python3.9/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variable as a keyword arg: x. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.\n",
      "  warnings.warn(\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:xlabel='AGE'>"
      ]
     },
     "execution_count": 233,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.boxplot(vte_uid['AGE'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 234,
   "id": "f4397b7a-ce2a-49a8-88c6-c14c1d442adf",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/kexinzhang/opt/anaconda3/lib/python3.9/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variable as a keyword arg: x. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.\n",
      "  warnings.warn(\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:xlabel='AGE'>"
      ]
     },
     "execution_count": 234,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.boxplot(nvte_uid['AGE'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 619,
   "id": "2548844a-0135-44b2-b3fb-2eb41b712567",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_vte_uid = vte_uid[vte_uid['AGE']<300].reset_index(drop=True)\n",
    "new_nvte_uid = nvte_uid[(nvte_uid['AGE']<300) & (nvte_uid['AGE']>0)].reset_index(drop=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 620,
   "id": "1970ca58-2476-45d4-b888-b9e60bc153ca",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(193, 30)"
      ]
     },
     "execution_count": 620,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_vte_uid.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 621,
   "id": "845f96cd-9999-412f-8ad1-1a7256e52528",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(5085, 28)"
      ]
     },
     "execution_count": 621,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_nvte_uid.shape"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "81ed400d-cf6f-404c-9b56-258faa8c3544",
   "metadata": {
    "tags": []
   },
   "source": [
    "##### Length stay check"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 622,
   "id": "a11ea15b-129c-438d-8176-94c0aadc9907",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/kexinzhang/opt/anaconda3/lib/python3.9/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variable as a keyword arg: x. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.\n",
      "  warnings.warn(\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:xlabel='LENGTH_STAY'>"
      ]
     },
     "execution_count": 622,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.boxplot(new_vte_uid['LENGTH_STAY'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 623,
   "id": "b0cc6476-907f-412b-9fd7-5e44f97a6578",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/kexinzhang/opt/anaconda3/lib/python3.9/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variable as a keyword arg: x. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.\n",
      "  warnings.warn(\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:xlabel='LENGTH_STAY'>"
      ]
     },
     "execution_count": 623,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.boxplot(new_nvte_uid['LENGTH_STAY'])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "97c196f8-43bb-4ea7-b703-081b2fcedea2",
   "metadata": {
    "tags": []
   },
   "source": [
    "#### admit times check"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 624,
   "id": "1c3162e7-eae8-4a50-91eb-4a880c26cf10",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/kexinzhang/opt/anaconda3/lib/python3.9/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variable as a keyword arg: x. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.\n",
      "  warnings.warn(\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:xlabel='ADMIT_TIMES'>"
      ]
     },
     "execution_count": 624,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.boxplot(new_vte_uid['ADMIT_TIMES'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 625,
   "id": "58709dad-8dd8-470a-ba32-8158f6f5bd16",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/kexinzhang/opt/anaconda3/lib/python3.9/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variable as a keyword arg: x. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.\n",
      "  warnings.warn(\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:xlabel='ADMIT_TIMES'>"
      ]
     },
     "execution_count": 625,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.boxplot(new_nvte_uid['ADMIT_TIMES'])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4192c0e0-a12c-435c-af00-d727b8c3921e",
   "metadata": {
    "tags": []
   },
   "source": [
    "#### readmit days check"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 626,
   "id": "da3f379b-0d57-4556-965b-45bd289b15cc",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/kexinzhang/opt/anaconda3/lib/python3.9/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variable as a keyword arg: x. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.\n",
      "  warnings.warn(\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:xlabel='READMIT_DAY'>"
      ]
     },
     "execution_count": 626,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.boxplot(new_vte_uid['READMIT_DAY'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 627,
   "id": "e95ddeb4-5c0b-4794-a542-5fa285edca46",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/kexinzhang/opt/anaconda3/lib/python3.9/site-packages/seaborn/_decorators.py:36: FutureWarning: Pass the following variable as a keyword arg: x. From version 0.12, the only valid positional argument will be `data`, and passing other arguments without an explicit keyword will result in an error or misinterpretation.\n",
      "  warnings.warn(\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "<AxesSubplot:xlabel='READMIT_DAY'>"
      ]
     },
     "execution_count": 627,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "sns.boxplot(new_nvte_uid['READMIT_DAY'])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "b6bd68ca-aa1e-4e58-b2e5-d5d0c35ed8d6",
   "metadata": {},
   "source": [
    "#### Drop Columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 628,
   "id": "e5e5305d-da8f-46fe-84d3-b383972e2481",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['SUBJECT_ID', 'HADM_ID', 'ADMITTIME', 'DISCHTIME', 'DEATHTIME',\n",
       "       'ADMISSION_TYPE', 'ADMISSION_LOCATION', 'DISCHARGE_LOCATION',\n",
       "       'INSURANCE', 'LANGUAGE', 'RELIGION', 'MARITAL_STATUS', 'ETHNICITY',\n",
       "       'EDREGTIME', 'EDOUTTIME', 'DIAGNOSIS', 'HOSPITAL_EXPIRE_FLAG',\n",
       "       'HAS_CHARTEVENTS_DATA', 'GENDER', 'DOB', 'DOD', 'DOD_HOSP', 'DOD_SSN',\n",
       "       'EXPIRE_FLAG', 'AGE', 'ADMIT_TIMES', 'LENGTH_STAY', 'READMIT_DAY'],\n",
       "      dtype='object')"
      ]
     },
     "execution_count": 628,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_nvte_uid.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 629,
   "id": "a85937d2-c0e6-4035-913a-4d78dfed3631",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_vte_uid = new_vte_uid.drop(['SEQ_NUM', 'ADMITTIME', 'DISCHTIME', 'DEATHTIME', 'ADMISSION_LOCATION', 'LANGUAGE', 'RELIGION', 'MARITAL_STATUS', 'EDREGTIME', 'EDOUTTIME', 'DOB', 'DOD', 'DOD_HOSP', 'DOD_SSN', 'EXPIRE_FLAG', 'AGE_RANGE', 'HOSPITAL_EXPIRE_FLAG', 'HAS_CHARTEVENTS_DATA', 'DISCHARGE_LOCATION'],axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 630,
   "id": "97474fdc-98cb-4a75-bd3b-40f4d975e395",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_nvte_uid = new_nvte_uid.drop(['ADMITTIME', 'DISCHTIME', 'DEATHTIME', 'ADMISSION_LOCATION', 'LANGUAGE', 'RELIGION', 'MARITAL_STATUS', 'EDREGTIME', 'EDOUTTIME', 'DOB', 'DOD', 'DOD_HOSP', 'DOD_SSN', 'EXPIRE_FLAG', 'HOSPITAL_EXPIRE_FLAG', 'HAS_CHARTEVENTS_DATA', 'DISCHARGE_LOCATION'],axis=1)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "605119c3-31f7-4cb9-9d3c-73b8ab2b768e",
   "metadata": {
    "tags": []
   },
   "source": [
    "# Normalize Continuous Variables"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 631,
   "id": "9a5b0e93-f17a-4fbf-afbb-3f3b0d37bc9c",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Normalize Data\n",
    "def NormalizeData(data):\n",
    "    return (data - np.min(data)) / (np.max(data) - np.min(data))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "9195c726-1ee7-471b-b5b6-5131f5764969",
   "metadata": {
    "tags": []
   },
   "source": [
    "### Age"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 632,
   "id": "4749d5fe-0d83-4a23-8de5-bcea27612d39",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_vte_uid['AGE'] = NormalizeData(new_vte_uid['AGE'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 633,
   "id": "05aac2cf-5af1-45aa-894e-15d7d170bb17",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_nvte_uid['AGE'] = NormalizeData(new_nvte_uid['AGE'])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "160e194d-dc2a-487c-8a27-0d57b6c9d042",
   "metadata": {},
   "source": [
    "### Length Stay"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 634,
   "id": "e29cb560-df82-4af0-a9aa-1b7165a5b709",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_vte_uid['LENGTH_STAY'] = NormalizeData(new_vte_uid['LENGTH_STAY'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 635,
   "id": "12b0ec63-75c7-4678-9243-6e9cf69d0d1d",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_nvte_uid['LENGTH_STAY'] = NormalizeData(new_nvte_uid['LENGTH_STAY'])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "55b256e6-c4b3-423a-9264-4788098dc226",
   "metadata": {},
   "source": [
    "### Admit Times"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 636,
   "id": "d81e75ad-5351-4e2f-9187-4f09af80f02b",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_vte_uid['ADMIT_TIMES'] = NormalizeData(new_vte_uid['ADMIT_TIMES'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 637,
   "id": "8bc22517-0fc8-47cf-9aad-ff953e344db6",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_nvte_uid['ADMIT_TIMES'] = NormalizeData(new_nvte_uid['ADMIT_TIMES'])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "c782559b-0fab-40b8-8aff-ad0e32cac505",
   "metadata": {},
   "source": [
    "### Readmit Days"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 638,
   "id": "d6e0ec4c-e899-4b59-9944-c0d52bc4d367",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_vte_uid['READMIT_DAY'] = NormalizeData(new_vte_uid['READMIT_DAY'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 639,
   "id": "5702ab1f-a309-4d20-8ca9-da60d8130fba",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_nvte_uid['READMIT_DAY'] = NormalizeData(new_nvte_uid['READMIT_DAY'])"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "df0a8c9b-53ce-4acb-ba47-316043850801",
   "metadata": {},
   "source": [
    "# Grouping For Diagnosis"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 283,
   "id": "21d08b2f-f3aa-4662-9b51-0506b9da8a8b",
   "metadata": {},
   "outputs": [],
   "source": [
    "# import mannual group csv file\n",
    "diag_norm = pd.read_csv('Diagnosis ICD9_Code - Number.csv')\n",
    "diag_V = pd.read_csv('Diagnosis ICD9_Code - V.csv')\n",
    "diag_E = pd.read_csv('Diagnosis ICD9_Code - E.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 284,
   "id": "211f76f2-e100-48d1-b614-c10954f8cbcc",
   "metadata": {},
   "outputs": [],
   "source": [
    "# subset the diagnosis dataframe and use it to create a dictionary which stores SID & HID as keys and ICD9_CODE as values\n",
    "dia_subset = df_dia_icd[['SUBJECT_ID', 'HADM_ID', 'ICD9_CODE']].reset_index(drop=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 359,
   "id": "7a75163f-54d1-4000-ba98-e3f4ea391a8e",
   "metadata": {},
   "outputs": [],
   "source": [
    "dia_subset = dia_subset.dropna(subset=['ICD9_CODE'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 291,
   "id": "876ab28d-e89c-482d-b339-1fab453e8313",
   "metadata": {},
   "outputs": [],
   "source": [
    "#dia_subset[(dia_subset['SUBJECT_ID']== 20) & (dia_subset['HADM_ID']== 157681)] # for test"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5cc87b5b-3da2-40c3-b904-31783be7c587",
   "metadata": {},
   "source": [
    "## Create an dictionary to store information about icd9 code for each SID and HID"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 361,
   "id": "305fa048-1a26-4a7c-b7e9-5ee852f4366f",
   "metadata": {},
   "outputs": [],
   "source": [
    "diagnosis_dict = {k: g[\"ICD9_CODE\"].tolist() for k,g in dia_subset.groupby(['SUBJECT_ID', 'HADM_ID'])}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 436,
   "id": "b90a6ef2-aba8-45a6-a2a1-1d64f66db1ca",
   "metadata": {},
   "outputs": [],
   "source": [
    "# diagnosis_dict.get((20, 157681)) # for test dictionary is correct"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 437,
   "id": "576b2849-1250-42e2-840e-9bdb74ec4539",
   "metadata": {},
   "outputs": [],
   "source": [
    "# diagnosis_dict.get((20, 157681))[0][:3]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 438,
   "id": "92dd71d7-f8ec-493e-bd87-07a106b071cb",
   "metadata": {},
   "outputs": [],
   "source": [
    "# diagnosis_dict.get((109, 173633))[-1]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 754,
   "id": "dc55d725-ef41-4657-a284-c48597c53b90",
   "metadata": {},
   "outputs": [],
   "source": [
    "#diagnosis_dict.get((17155,160858))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a14d0039-f276-4ce9-ad23-b132867511bb",
   "metadata": {},
   "source": [
    "## Create a function for each row to add their diagnosis information"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 378,
   "id": "9fb74311-d109-4b83-a498-d747260e02c3",
   "metadata": {},
   "outputs": [],
   "source": [
    "# create a new dataframe recording SID & HID & grouping information\n",
    "new_diag = dia_subset[['SUBJECT_ID', 'HADM_ID']].drop_duplicates().reset_index(drop=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 379,
   "id": "d2419397-cce4-41ce-8006-1385c89b29f5",
   "metadata": {},
   "outputs": [],
   "source": [
    "col_list = list(diag_norm['col_name'].values)+list(diag_V['col_name'].values)+list(diag_E['col_name'].values)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 380,
   "id": "6a01414e-c028-4e44-a6bd-76ea210374b9",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/kexinzhang/opt/anaconda3/lib/python3.9/site-packages/pandas/core/frame.py:3645: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`\n",
      "  self[col] = value\n"
     ]
    }
   ],
   "source": [
    "new_diag[col_list] = 0"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 381,
   "id": "11fe284a-0117-4199-b33c-16a3b2f1cb06",
   "metadata": {},
   "outputs": [],
   "source": [
    "# vte_id = vte_id[['SUBJECT_ID','HADM_ID']].apply(tuple, axis=1)\n",
    "def grouping(row):\n",
    "    SID = row['SUBJECT_ID']\n",
    "    HID = row['HADM_ID']\n",
    "    ID_tuple = (SID, HID)\n",
    "    ICD_list = diagnosis_dict.get(ID_tuple)\n",
    "    #print('ok')\n",
    "    \n",
    "    for i in range(len(ICD_list)):\n",
    "        digit = str(ICD_list[i])\n",
    "        \n",
    "        # case start with V\n",
    "        if digit[0] == 'V':\n",
    "            digit = int(digit[1:3])\n",
    "            \n",
    "            for index, r in diag_V.iterrows():\n",
    "                if digit >= r['low'] and digit <= r['high']:\n",
    "                    row[r['col_name']] = 1\n",
    "                    break\n",
    "                    \n",
    "        elif digit[0] == 'E':\n",
    "            digit = int(digit[1:4])\n",
    "            \n",
    "            for index, r in diag_E.iterrows():\n",
    "                if digit >= r['low'] and digit <= r['high']:\n",
    "                    row[r['col_name']] = 1\n",
    "                    break\n",
    "                    \n",
    "        else:\n",
    "            digit = int(digit[:3])\n",
    "            \n",
    "            for index, r in diag_norm.iterrows():\n",
    "                if digit >= r['low'] and digit <= r['high']:\n",
    "                    row[r['col_name']] = 1 \n",
    "                    break\n",
    "    return row"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 750,
   "id": "92940839-074c-4db7-9f52-1a6f8fe7b713",
   "metadata": {},
   "outputs": [],
   "source": [
    "#new_diag = new_diag.apply(grouping, axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 751,
   "id": "c2d59d86-4fad-4b30-82db-0b8fd43ea9ad",
   "metadata": {},
   "outputs": [],
   "source": [
    "# temp = new_diag[(new_diag['SUBJECT_ID'] == 17155) & (new_diag['HADM_ID'] == 160858)] # test"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 752,
   "id": "0fed909e-4dfa-40fc-a4bc-07296ae74d91",
   "metadata": {},
   "outputs": [],
   "source": [
    "# code = list(temp.apply(lambda row: row[row == 1].index.tolist(), axis=1)) # test"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 753,
   "id": "37f58416-4f02-4e3e-bc13-c4ee61a01967",
   "metadata": {},
   "outputs": [],
   "source": [
    "# code[0] #test"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 427,
   "id": "73bfac34-33b6-4c3e-a469-72bf23c8fe0c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(58929, 186)"
      ]
     },
     "execution_count": 427,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_diag.shape"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "82919fbb-dd4b-4064-b3df-764544a6e6ec",
   "metadata": {},
   "source": [
    "# Grouping For Procedure"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 432,
   "id": "79cc9f53-0983-493b-8e96-13eb7c3656f7",
   "metadata": {},
   "outputs": [],
   "source": [
    "# import mannual group csv file\n",
    "proce_code = pd.read_csv('Procedure ICD9_Code.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 423,
   "id": "c49ef5d2-0cfb-4861-a421-ed76ea501ccc",
   "metadata": {},
   "outputs": [],
   "source": [
    "proce_subset = df_proce[['SUBJECT_ID', 'HADM_ID', 'ICD9_CODE']].reset_index(drop=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 425,
   "id": "8be0b6dd-3e86-48b1-b61d-e8ab275db1b6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#proce_subset.isna().sum()"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f81c238b-2ef8-4fcf-b4e3-31ac0351c642",
   "metadata": {},
   "source": [
    "## Create dictionary for procedure to store icd9 code"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 426,
   "id": "418d96fc-c784-4714-8624-3936a4c73a71",
   "metadata": {},
   "outputs": [],
   "source": [
    "procedure_dict = {k: g[\"ICD9_CODE\"].tolist() for k,g in proce_subset.groupby(['SUBJECT_ID', 'HADM_ID'])}"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 507,
   "id": "55be2d99-8448-4228-ae6d-4e7261fae17b",
   "metadata": {},
   "outputs": [],
   "source": [
    "# str(procedure_dict.get((2592, 130856)))"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "a4aa957a-3b3d-4626-a6a7-3384abb468be",
   "metadata": {},
   "source": [
    "## Create a function for each row to add their procedure information"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 487,
   "id": "1bbc9952-e3a1-4895-92fa-744f8262ef5f",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_proce = proce_subset[['SUBJECT_ID', 'HADM_ID']].drop_duplicates().reset_index(drop=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 488,
   "id": "60844cfc-d75b-464d-8d28-351365d637b7",
   "metadata": {},
   "outputs": [],
   "source": [
    "p_col_list = list(proce_code['col_name'].values)\n",
    "p_col_list = list(str(i) for i in p_col_list)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 489,
   "id": "0801d786-13d8-467d-98c0-41201c8e6eca",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/kexinzhang/opt/anaconda3/lib/python3.9/site-packages/pandas/core/frame.py:3645: PerformanceWarning: DataFrame is highly fragmented.  This is usually the result of calling `frame.insert` many times, which has poor performance.  Consider joining all columns at once using pd.concat(axis=1) instead.  To get a de-fragmented frame, use `newframe = frame.copy()`\n",
      "  self[col] = value\n"
     ]
    }
   ],
   "source": [
    "new_proce[p_col_list] = 0"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 493,
   "id": "ab024568-f021-40c5-9039-db849a361331",
   "metadata": {},
   "outputs": [],
   "source": [
    "def pgrouping(row):\n",
    "    SID = row['SUBJECT_ID']\n",
    "    HID = row['HADM_ID']\n",
    "    ID_tuple = (SID, HID)\n",
    "    ICD_list = procedure_dict.get(ID_tuple)\n",
    "    \n",
    "    for i in range(len(ICD_list)):\n",
    "        digit = int(str(ICD_list[i])[:2])\n",
    "        colname = str(digit)\n",
    "        \n",
    "        row[colname] = 1\n",
    "        \n",
    "    return row\n",
    "        "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 494,
   "id": "7bf088b0-abc7-4976-96fd-9b2911b431c4",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_proce = new_proce.apply(pgrouping, axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 747,
   "id": "4761f981-0b18-437b-9113-4445736efa94",
   "metadata": {},
   "outputs": [],
   "source": [
    "#temp2 = new_proce[(new_proce['SUBJECT_ID'] == 17155) & (new_proce['HADM_ID'] == 160858)]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 748,
   "id": "102049b8-a392-41ab-880d-55bc3fdd036c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#code2 = list(temp2.apply(lambda row: row[row == 1].index.tolist(), axis=1))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 749,
   "id": "0717ecf7-b5c0-4d24-bce9-a0fd845a0b73",
   "metadata": {},
   "outputs": [],
   "source": [
    "#code2"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 511,
   "id": "9c1c0844-5f74-46c2-a00d-f827d160b9b2",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(52243, 102)"
      ]
     },
     "execution_count": 511,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_proce.shape"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "bf2bc618-9d21-48a0-bdac-a89df7842dde",
   "metadata": {},
   "source": [
    "# Merge diagnosis and procedure"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 677,
   "id": "5e284016-9d8e-484b-bea4-ffc6f93b055c",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_dia_pro = pd.merge(new_diag, new_proce, how='outer', on=['SUBJECT_ID', 'HADM_ID'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 746,
   "id": "1acbad4f-28c1-426f-a10d-559e6752f18b",
   "metadata": {},
   "outputs": [],
   "source": [
    "#new_dia_pro[(new_dia_pro['SUBJECT_ID'] == 17155) & (new_dia_pro['HADM_ID'] == 160858)]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "5bf1cef7-3baa-4eb6-a100-17a36089c1e2",
   "metadata": {},
   "source": [
    "# Group For Lab Test"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 530,
   "id": "a4e4e7a2-3768-4c34-b008-8c3a7cc8b29e",
   "metadata": {},
   "outputs": [],
   "source": [
    "# import data\n",
    "d_labitem = pd.read_csv('D_LABITEMS.csv')\n",
    "labevent = pd.read_csv('LABEVENTS.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 572,
   "id": "131d5d00-9908-4a73-92c8-bf70b2b99fcb",
   "metadata": {},
   "outputs": [],
   "source": [
    "item_cate = d_labitem[['ITEMID', 'CATEGORY']]\n",
    "labevent_sub = labevent[['SUBJECT_ID', 'HADM_ID', 'ITEMID']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 573,
   "id": "ccffbc35-39fd-4ddb-98b4-db021cf4bef9",
   "metadata": {},
   "outputs": [],
   "source": [
    "labevent_sub = labevent_sub.dropna(subset=['HADM_ID']).reset_index(drop=True)\n",
    "labevent_sub['HADM_ID'] = labevent_sub['HADM_ID'].astype(int)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 574,
   "id": "50814c21-eadf-4de2-9758-e64fdc9d0eae",
   "metadata": {},
   "outputs": [],
   "source": [
    "lab_cate = pd.merge(labevent_sub, item_cate, how='inner', on='ITEMID')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 575,
   "id": "891e7a57-6c68-434d-95f2-64ea1923d72f",
   "metadata": {},
   "outputs": [],
   "source": [
    "lab_cate = lab_cate.drop(['ITEMID'], axis=1)\n",
    "lab_cate['CATEGORY'] = lab_cate['CATEGORY'].str.lower()\n",
    "lab_cate = lab_cate.drop_duplicates().reset_index(drop=True)"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "890cf6fe-350a-408a-b2ab-481e24d7b911",
   "metadata": {},
   "source": [
    "## Create a dictionary to store lab test category"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 590,
   "id": "ddb0e65f-e48f-42d5-93aa-3fd1bac7f03a",
   "metadata": {},
   "outputs": [],
   "source": [
    "lab_dict = {k: g[\"CATEGORY\"].tolist() for k,g in lab_cate.groupby(['SUBJECT_ID', 'HADM_ID'])}"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "e7d181ca-dca3-41f9-b2b8-d4b16672d129",
   "metadata": {},
   "source": [
    "## Create a function to add categories for each row"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 598,
   "id": "d7195f61-d8d9-469e-a024-8e0d15b67212",
   "metadata": {},
   "outputs": [],
   "source": [
    "lcol_name = list(lab_cate['CATEGORY'].unique())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 600,
   "id": "21cc309a-6868-40ee-a93b-90718f8101a8",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_lab = lab_cate[['SUBJECT_ID','HADM_ID']].drop_duplicates().reset_index(drop=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 602,
   "id": "064d8e9e-a2c2-4168-97ca-60b6dad6f497",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_lab[lcol_name] = 0"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 604,
   "id": "1b48e464-c91a-4e6e-86af-3422ef46e150",
   "metadata": {},
   "outputs": [],
   "source": [
    "def lab_grouping(row):\n",
    "    SID = row['SUBJECT_ID']\n",
    "    HID = row['HADM_ID']\n",
    "    ID_tuple = (SID, HID)\n",
    "    cate_list = lab_dict.get(ID_tuple)\n",
    "    \n",
    "    for i in range(len(cate_list)):\n",
    "        row[cate_list[i]] = 1\n",
    "        \n",
    "    return row"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 609,
   "id": "135dcfb5-21eb-4de6-b2df-dab96c6629a3",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_lab = new_lab.apply(lab_grouping, axis=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 745,
   "id": "9d628478-1af2-4457-98d2-659ef639be1e",
   "metadata": {},
   "outputs": [],
   "source": [
    "#new_lab[(new_lab['SUBJECT_ID'] == 17155) & (new_lab['HADM_ID'] == 160858)]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "4c5cb64a-c184-4453-a8c2-50f8c7048e8d",
   "metadata": {},
   "source": [
    "# Merge dia_pro with Lab test"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 681,
   "id": "a840eab9-5378-4c01-8d6e-a76a61703de4",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_allgroup = pd.merge(new_dia_pro, new_lab, how='outer', on=['SUBJECT_ID', 'HADM_ID'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 744,
   "id": "e3cbd469-b427-40de-b5e1-40289a4534a6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#new_allgroup[(new_allgroup['SUBJECT_ID'] == 17155) & (new_allgroup['HADM_ID'] == 160858)]"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f853345d-e49a-457e-911d-efdc43c5a89d",
   "metadata": {},
   "source": [
    "# Merge with Group I"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 684,
   "id": "05a246c5-f903-451c-ba00-179867b965ed",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(193, 11)"
      ]
     },
     "execution_count": 684,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_vte_uid.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 732,
   "id": "37bdf4ad-bf4e-43f4-b8e4-46fa86ed7bb0",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_vte = pd.merge(new_vte_uid, new_allgroup, how='inner', on=['SUBJECT_ID', 'HADM_ID'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 733,
   "id": "e0f266b8-fa0e-417d-83b8-2011a1aca66e",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "Index(['SUBJECT_ID', 'HADM_ID', 'ADMISSION_TYPE', 'INSURANCE', 'ETHNICITY',\n",
       "       'DIAGNOSIS', 'GENDER', 'AGE', 'ADMIT_TIMES', 'LENGTH_STAY',\n",
       "       ...\n",
       "       '93', '94', '95', '96', '97', '98', '99', 'chemistry', 'hematology',\n",
       "       'blood gas'],\n",
       "      dtype='object', length=298)"
      ]
     },
     "execution_count": 733,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_vte.columns"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 734,
   "id": "cf9849af-943d-45ae-9dbf-9f546ce4d468",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_vte = new_vte.dropna().reset_index(drop=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 735,
   "id": "50df4ead-47c3-44a8-b608-6459fc4ca723",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(186, 298)"
      ]
     },
     "execution_count": 735,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_vte.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 736,
   "id": "d4778f73-44b7-41dd-b4b6-e7bbd20e8f36",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_vte.iloc[:, 11:] = new_vte.iloc[:, 11:].astype(int)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 737,
   "id": "af433abd-d76e-4bc1-9c8b-253a9371e147",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_vte.to_csv('New_VTE.csv') # export to csv file"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "ce40d02a-36cb-419f-a66f-9655600c8851",
   "metadata": {},
   "source": [
    "# Merge with Group II"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 645,
   "id": "86a90bd9-0a80-48f1-abcc-f80b1adef6f7",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(5085, 11)"
      ]
     },
     "execution_count": 645,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_nvte_uid.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 738,
   "id": "796eee8b-499a-4ace-8421-82a3fbb32599",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_nvte = pd.merge(new_nvte_uid, new_allgroup, how='left', on=['SUBJECT_ID', 'HADM_ID'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 739,
   "id": "2704bcec-2784-4c58-86d8-6a86a6e3d287",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_nvte['chemistry'] = new_nvte['chemistry'].fillna(0)\n",
    "new_nvte['hematology'] = new_nvte['hematology'].fillna(0)\n",
    "new_nvte['blood gas'] = new_nvte['blood gas'].fillna(0)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 740,
   "id": "626783dc-ea69-4900-b130-3338b7c7fa94",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_nvte = new_nvte.dropna().reset_index(drop=True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 741,
   "id": "d9d54557-f43a-4904-b02e-be0a4984773f",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(4444, 298)"
      ]
     },
     "execution_count": 741,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "new_nvte.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 742,
   "id": "e8a8906d-bc6d-450f-b566-b16a94daeede",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_nvte.iloc[:, 11:] = new_nvte.iloc[:, 11:].astype(int)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 743,
   "id": "cc4d1b20-40f6-4d1b-af77-e6d30771d479",
   "metadata": {},
   "outputs": [],
   "source": [
    "new_nvte.to_csv('New_NVTE.csv')"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
